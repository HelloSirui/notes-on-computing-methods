\documentclass[opensource,b5paper,sourcefont]{qyxf-book}
\usepackage{makeidx}
\usepackage{etoolbox}
\makeindex

\title{计算方法笔记}
\subtitle{Notes on Computing Methods}
\author{王天浩，吴思源，尤佳睿}
\typo{xjtu-blacksmith}
\date{2019 年 6 月 6 日}
\sourcepage{\url{https://github.com/qyxf/Tutorials}}

\newcounter{entry}
\counterwithin*{entry}{chapter}

\newcommand{\example}{\stepcounter{entry}\noindent$\text{\ding{48}}{}_{\makebox%
[10pt]{\footnotesize\bf\arabic{chapter}.\arabic{entry}}\hspace{5pt}}$}
\newcommand{\entry}{\stepcounter{entry}\noindent$\text{\ding{226}}_{\makebox%
[10pt]{\footnotesize\bf\arabic{chapter}.\arabic{entry}}\hspace{5pt}}$}
\newcommand{\defwidth}{.2\textwidth}
\newcommand{\tl}{\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\newcommand{\add}[1]{\textsf{[#1]}}
\newcommand{\e}{\mathrm{e}}
\newcommand{\di}{\mathrm{d}}
\newcommand{\del}{\mathrm{}}
\newcommand{\sothat}{\ \Rightarrow\ }
\newcommand{\trm}{\stepcounter{entry}\noindent$\text{\ding{43}}_{\makebox%
[10pt]{\footnotesize\bf\arabic{chapter}.\arabic{entry}}\hspace{5pt}}$}
\newcommand{\define}{\trm}
\newcommand{\key}[1]{\textbf{#1}\index{#1}}
\newcommand{\setkey}[2]{\textbf{#1}\index{#2}}
\newcommand{\vphi}{\varphi}
\newcommand{\vepsilon}{\varepsilon}
\newcommand{\dsum}{\sum\limits}

\renewcommand{\emph}[1]{\underline{#1}}

\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\cond}{Cond}
\DeclareMathOperator{\sgn}{sgn}

\begin{document}

\maketitle

\frontmatter
\chapter*{前言}
计算方法是本校钱学森班、少年班等试验班的同学必修的一门数学基础课程，其内容包括解决一些计算问题（如解线性方程组、插值与逼近、数值微积分等）的常用算法，以及针对这些算法之误差与稳定性的相关数学理论。相较于其他的数学课程，计算方法课程具有内容丰富、实用性强等特点，但也兼有一般数学课程内容深、考点多的性质。可以说，计算方法课程是工科学生在走向专业课程之前所要翻越的最后一座数学理论「大山」。

基于以上的特点，在计算方法课程的学习与复习过程中，便非常需要一本\textbf{详略适中}、\textbf{重点突出}的课程笔记，以资参考。2014级少年班的王天浩同学，于此方面做了相当好的工作，在学习本课程期间整理了十分详尽的课程笔记，基本上达到了以上所提到的要求。……

为方便之后的同学复习计算方法课程，经与王天浩学长协商，我自2019年6月6日开始将原有的纸质扫描笔记以\LaTeX 整理为电子版，补足了语言上的一些省略、缺失，并增写了许多注记、说明。……

\subsection*{正文格式说明}
电子版笔记基本上遵循了原有纸质笔记的框架，但相较与原来的样式更为清晰、简明。这份笔记的正文中包含了这样几类内容：
\begin{description}
    \item[零碎的知识点] 用无序号列表的形式列出。
    \item[例题] 以加粗的「\textbf{例}」字引导，通常是对其正上方那一个或几个知识点的具体呈现与演示。
    \item[注记] 用脚注的方式给出，通常是对正文内容的进一步阐释。大部分注记标明了「——编者注」的字样，这些都是编者所加上的。
    % \item[正文补正] 用方括号包围的黑体字呈现，这些内容是编者在原有笔记之基础上所做的补充与删改。凡未这样改动的部分，则都保持了原来的模样。
\end{description}

\subsection*{帮助我们改进这份笔记}
一本好的教科书，来自于相关教师历经数代、数十年的逐次再版改进；一份好的笔记，同样也需要长期的维护、改进才能够最终创造出来。……

\begin{flushright}
能动少C71 尤佳睿
\footnote{个人博客：\url{https://www.cnblogs.com/xjtu-blacksmith/}。}
\\2019 年 6 月 6 日
\end{flushright}
\cleardoublepage

\tableofcontents

\mainmatter
\chapter{误差}
\section{真值与误差}
\entry 有测量就会有误差。通常，将某数学量、物理量的\key{真值}记为$x$（不加任何修饰符），而将测量或计算所得的$x$的\key{近似值}记作$\tilde{x}$。

\entry 两种误差：$\begin{cases}\Delta x=x-\tilde{x} \text{\ (绝对误差)}\\ \delta x=\frac{x-\tilde{x}}{x}\text{\ (相对误差)}\end{cases}$

\entry 两种误差限：$\begin{cases}|\Delta x|\leq\varepsilon\text{\ (绝对误差限)}\\|\delta x|\leq\varepsilon_r\text{\ (相对误差限)}\end{cases}$

\entry 相对误差较小时，有近似计算式\footnote{在估计误差时，真值$x$往往难以确定，但绝对误差$|\Delta x|$或绝对误差限$\varepsilon$往往能够确定下来。}
：$|\delta x|\approx\frac{|x-\tilde{x}|}{\tilde{x}}=\frac{\Delta x}{\tilde{x}}\leq\frac{|\varepsilon|}{\tilde{x}}$

\entry 若$|\Delta x|=|x-\tilde{x}|\leq0.5\times10^{-n}$，则称$x$的近似值$\tilde{x}$\emph{准确到第$n$位小数}。

\example 设$x=0.31682$，则$\tilde{x}_1=0.3$精确到$1$位有效数字，$\tilde{x}_2=0.32$精确到$2$位，$\tilde{x}_3=0.317$精确到$3$位，$\tilde{x}_4=0.3168$精确到$4$位。若取$\tilde{x}_5=0.3169$为$x$的近似值，则其仅精确到$3$位小数。

\section{浮点运算与浮点数集}
\entry 在计算机中，实数将被储存为\key{浮点数}，故计算机中的实数运算常被称作\key{浮点运算}。为此，有下面的一些概念与理论。

\entry \key{浮点运算量}：记\emph{一次加法和一次乘法}（如$a+b\times c$）所需的时间为一个\key{时间单位}，记为flop。

\example 设$\mathbf{A}_1$为一$10\times20$的矩阵，$\mathbf{A}_2$为一$20\times50$的矩阵，欲计算$\mathbf{A}_1\cdot\mathbf{A}_2$，则运算量为$10\times20\times50=10000$ flop，如图\ref{1-1}所示。
\begin{figure}[htbp]
\small\centering
\includegraphics[width=\defwidth]{default.png}
\caption{矩阵乘法运算量示意图}\label{1-1}
\end{figure}

\entry \key{浮点数集}：在10进制中，浮点数$\tilde{x}$（或一实数$x$的近似$t$位有效数字的浮点数$\tilde{x}$）可表示如下：
\[fl(x)=\tilde{x}=\pm\left\{\frac{x_1}{10}+\frac{x_2}{10^2}+\frac{x_3}{10^3}+\cdots+\frac{x_t}{10^t}\right\}\times10^l\ (\tilde{x}=0.x_1x_2x_3\cdots x_t\times10^l)\]
其中$1\leq x_1<10$，$0\leq x_j<10$，$j=2,3,\cdots,t$。类似的，在$\beta$进制中，一个数的表示方式：
\[fl(x)=\tilde{x}=\pm\left\{\frac{x_1}{\beta}+\frac{x_2}{\beta^2}+\cdots+\frac{x_t}{\beta^t}\right\}\times\beta^l\]
其中$1\leq x_1<\beta$，$0\leq x_j<\beta$，$j=2,3,\cdots,t$。$\beta^l$称为指数部分，指数$l$满足$L\leq l\leq U$，$L$与$U$分别为下界与上界；$0.x_1x_2\cdots x_t$称为尾数。$fl(x)$称为一个\key{规格化浮点数}。

\entry 称计算机中所能表示的全体数的集合称为\key{浮点数集}，记为$F(\beta,t,L,U)$。
\begin{equation}
F(\beta,t,L,U)=\{0\}\cup\left\{\pm\left(\frac{x_1}{\beta}+\frac{x_2}{\beta^2}+\cdots+\frac{x_t}{\beta^t}\right)\times\beta^l:L\leq l\leq U\right\}
\end{equation}

\example \textsf{C++}里的\verb|float|：4字节内存，32个二进制bit，如图\ref{1-2}所示。可以将这一浮点数集记为$F(2,23,-128,127)$。
\begin{figure}[htbp]
\small\centering
\includegraphics[width=\defwidth]{default.png}
\caption{\textsf{C++}中\texttt{float}类型变量的储存原理}\label{1-2}
\end{figure}

\entry 浮点数集中的数的个数：$N=2\cdot(\beta-1)\cdot\beta^{t-1}\cdot(U-L+1)+1$

\entry 浮点数$fl(x)$与对应真值$x$的误差：
\begin{itemize}\tl
    \item 绝对误差：$|x-fl(x)|\leq\dfrac12\beta^{-t}\times\beta^l=\dfrac12\beta^{l-t}$
    \item 相对误差：由$|x|\geq0.1\times\beta^l$，有$\dfrac{|x-fl(x)|}{|x|}\leq\dfrac{\beta^{l-t}/2}{\beta^{l-1}}=\dfrac12\beta^{1-t}$
\end{itemize}
此类误差称为\key{舍入误差}。

\entry 计算结果的错误/误差：
\begin{enumerate}\tl
    \item $l\notin[L,U]$：\key{上溢}（$l\geq L$）会出错，\key{下溢}（$l\leq U$）变为$0$。
    \item 尾数多于$t$位：自动进行舍入处理，造成误差
    \item 有效数字丢失（\emph{「大数吃小数」}）
\end{enumerate}


\example 设计算时保留4位有效数字，则$1234+0.3678=1234.3678=1234.3678\approx1234$，在此发生了「大数吃小数」的现象。

\entry 设计数值计算的算法时，应结合浮点数具有的特性，避免上面所提到的各类计算错误。为此，提出以下几条\emph{浮点运算原则}：
\begin{enumerate}\tl
    \item 避免产生大结果的运算，避免小数作为除数。
    \item 避免「大」、「小」数相加减，防止大数吃小数。
    \item 避免相近数直接相减，防止有效数字损失。
    \item 简化运算步骤，减少运算次数
    \footnote{由此避免各类误差的逐次累计。——编者注}。
\end{enumerate}

若原有的计算公式不符合以上的这些原则，则可以通过对原式的等价变换或近似处理，使之符合上面的原则。

\example 设$|x|\ll1$，则可改写数值计算公式$\ln\dfrac{1-\sqrt{1-x^2}}{|x|}$为以下形式，以避免小数作分母：
\[\ln\frac{1-\sqrt{1-x^2}}{|x|}=\ln\frac{x^2}{|x|\cdot(1+\sqrt{1-x^2})}=\ln\frac{|x|}{1+\sqrt{1-x^2}}\]

\section{计算方法的研究内容}
\entry 计算方法课程，并不仅仅包含各类数值计算方法。归结而言，计算方法课程的研究内容可以归纳为：
\begin{enumerate}\tl
    \item 某一问题的数值计算算法（即通常意义上的「计算方法」）；
    \item 这些算法的误差、复杂性或收敛速度之估计。
\end{enumerate}
后者至关重要。对于算法的误差或复杂性分析，使这门课程区别于一般的工具性课程。

\entry 针对一些模型，还存在着一类特定的问题，即\textbf{病态问题}。为度量这类问题的性质，需要用到\key{条件数}。
\begin{itemize}\tl
    \item 根据输入数据的微小变化能引起问题之解变化的大小程度，可以将数值计算问题区别为两类：若由此能引起解的很大变化，则称问题是\textbf{病态}的；否则，称一个问题是\textbf{良态}的。病态问题不易精确求解。
    \item \key{条件数}：输入数据$x,\tilde{x}$，输出$f(x),f(\tilde{x})$。设$x\neq0$，$f(x)\neq0$，若存在$m>0$使：
    \[\frac{|f(x)-f(\tilde{x})|}{|f(x)|}\leq m\cdot\frac{|x-\tilde{x}|}{|x|}\ (\text{输出误差}\leq m\cdot\text{输入误差})\]
    则将$m$称为该问题的\textbf{条件数}，记为$\cond(f)$。
\end{itemize}

\example $y=\varphi(x_1,x_2,\cdots,x_n)$。输入为$\tilde{x}_1,\tilde{x}_2,\cdots,\tilde{x}_n$，近似解$\tilde{y}=\varphi(\tilde{x}_1,\tilde{x}_2,\cdots,\tilde{x}_n)$，则有
\begin{gather}
\Delta y=\varphi(x_1,x_2,\cdots,x_n)-\varphi(\tilde{x}_1,\tilde{x}_2,\cdots,\tilde{x}_n)
\approx\sum_{i=1}^n\frac{\partial\varphi(\tilde{x}_1,\tilde{x}_2,\cdots,\tilde{x}_n)}{\partial x_i}\Delta x_i\\
\delta y=\frac{\Delta y}{y}\approx\sum_{i=1}^n\frac{\partial\varphi(\tilde{x}_1,\tilde{x}_2,\cdots,\tilde{x}_n)}{\partial x_i}\cdot\frac{\Delta x_i}{y}
=\sum_{i=1}^n\frac{\partial\varphi(\tilde{x}_1,\tilde{x}_2,\cdots,\tilde{x}_n)}{\partial x_i}\cdot\frac{x_i}{y}\cdot\delta x_i
\end{gather}
故可见$\left|\frac{\partial\varphi(\tilde{x}_1,\tilde{x}_2,\cdots,\tilde{x}_n)}{\partial x_i}\cdot\frac{x_i}{y}\right|$即条件数。

\entry \key{稳定性}（数值稳定性）：运算中\textbf{舍入误差积累}是否影响结果的可靠性。

\example 欲用数值计算方法求解由$I_k=\e^{-1}\int_0^1x^k\e^x\di x,\ k=0,1,\cdots,7$所定义的一系列定积分的值。
\begin{itemize}\tl
    \item 算法1：构建递推公式
    \begin{equation}\label{1-e1}
    \left\{
    \begin{aligned}
    I_0&=\e^{-1}\int_0^1\di x=1-\dfrac1\e\\
    I_k&=\e^{-1}\int_0^1x^k\e^x\di x=\e^{-1}x^k\cdot\left.\e^{-1}\right|_0^1-\e^{-1}\int_0^1k\cdot\e^xx^{k-1}\di x=1-kI_{k-1}
    \end{aligned}
    \right.
    \end{equation}
    利用递推关系依次计算$I_0\rightarrow I_1\rightarrow I_1\rightarrow\cdots\rightarrow I_7$。
    \item 算法2：近似计算$I_7$，利用递推关系
    \footnote{即将(\ref{1-e1})式移项，反得$I_{k-1}=\dfrac{1-I_k}{k}$。——编者注}
    依次计算$I_7\rightarrow I_6\rightarrow\cdots\rightarrow I_0$。
\end{itemize}
实际上就整体而言，算法2精度更高。对算法1递推公式$I_k=1-kI_{k-1}$。若$I_{k-1}$有舍入误差$\Delta I_{k-1}$（或记作$\Delta$），则$\tilde{I}_k=1-k(I_{k-1}+\Delta)=I_k-k\cdot\Delta$，误差被放大
\footnote{对算法2的递推公式做类似分析，可见$\tilde{I}_{k-1}=I_{k-1}-\Delta/k$，即误差被减小到原来的$1/k$倍，这是大大缩小了。故算法2较算法1更为稳定。——编者注}。

\chapter{线性方程组直接解法}
\section{Gauss消元法的引入}

\entry 整体思路：
\begin{enumerate}\tl
    \item 先推得$\mathbf{Ax}=\mathbf{b}\sothat\mathbf{x}=\mathbf{A}^{-1}\mathbf{b}$，再求$\mathbf{A}^{-1}$（初等行变换法、伴随矩阵法、Gauss-Jordan消去法）
    \item Crammer法则：$\mathbf{Ax}=\mathbf{b}\sothat x_i=\frac{|\mathbf{A}_i|}{|\mathbf{A}|}$，浮点运算数$N=(n^2-1)\cdot n!+n$ flop（很大）
\end{enumerate}

\entry Gauss消去法：降维（$n\to n-1\to\cdots\to1$）
\begin{figure}[htbp]
\small\centering
\includegraphics[width=\defwidth]{default.png}
\caption{Gauss消去法步骤示意图}\label{2-f1}
\end{figure}
\begin{itemize}\tl
\item 消去运算量：$N_1=\sum\limits_{k=1}^{n-1}(n-k)(n-k+2)=\frac{n^3}3+n^2-\frac{5n}6$
\item 回代运算量：$N_2=1+2+\cdots+n=\frac{n(n+1)}2$
\item 总计运算量：$N=N_1+\frac32N_2=\frac{n^3}3+n^2-\frac n3=O(n^3)$
\end{itemize}

\entry 可能出现的问题：（主要是消去过程中）
\begin{enumerate}\tl
    \item $a_{kk}^{(k-1)}=0$，无法进行
    \item $|a_{kk}^{(k-1)}|\ll|a_{ik}^{(k-1)}|\ (i=k+1,k+2,\cdots,n)$，误差极大（大/小=大，误差被放大）
\end{enumerate}
对 Problem 1，只要满足：(1)$\mathbf{A}$是方阵；(2)$|\mathbf{A}|\neq0$，则可通过换行达到解决问题。

\trm $a_{kk}^{(k-1)}$不为$0$的充要条件是$\mathbf{A}$的$1$阶与$k$阶主子式均不为$0$，即
\[a_{kk}^{(k-1)}\neq0\ \Leftrightarrow\ D_1=a_{11}\neq0,\ D_k=\left|\begin{array}{cccc}a_{11}&a_{12}&\cdots&a_{1k}\\a_{21}&a_{22}&\cdots&a_{2k}\\\vdots&\vdots&\ddots&\vdots\\a_{k1}&a_{k2}&\cdots&a_{kk}\end{array}\right|\]
对 Problem 2，则不易解决\footnote{可参见下一节中的「列主元Gauss消元法」}。

\define 设矩阵$\mathbf{A}$满足$\sum\limits_{j=1,j\neq i}^n|a_{ij}|<|a_{ii}|$~，则称$\mathbf{A}$是严格对角占优矩阵。

\entry Gauss消去法顺利进行条件：
\begin{enumerate}\tl
    \item $\mathbf{A}$各阶顺序主子式不等于$0$。
    \item $\mathbf{A}$是对称正定阵。
    \item $\mathbf{A}$是严格对角占优矩阵。
\end{enumerate}


\section{Gauss消元法的改进}
\entry \key{列主元Gauss消元法}. 消去进行到第$k$步时如下所示：
\[\begin{pmatrix}a_{11}^{(k-1)}&a_{12}^{(k-1)}&\cdots&a_{1k}^{(k-1)}&\cdots&a_{1n}^{(k-1)}\\0&a_{22}^{(k-1)}&\cdots&a_{2k}^{(k-1)}&\cdots&a_{2n}^{(k-1)}\\\vdots&\vdots&&\vdots&&\vdots\\0&0&\cdots&a_{kk}^{(k-1)}&\cdots&a_{kn}^{(k-1)}\\\vdots&\vdots&&\vdots&&\vdots\\0&0&\cdots&a_{nk}^{(k-1)}&\cdots&a_{nn}^{(k-1)}\end{pmatrix}\]
选取$\max(|a_{ik}^{(k-1)}|)\ i=k,k+1,\cdots,n$的一行与第$k$行互换，继续消去（算法较稳定）

\entry Gauss消去法矩阵形式：
\[\mathbf{A}=\mathbf{A}^{(0)}=\begin{pmatrix}\ast&\ast&\ast&\ast\\\ast&\ast&\ast&\ast\\\ast&\ast&\ast&\ast\\\ast&\ast&\ast&\ast\end{pmatrix}\sothat\mathbf{A}^{(1)}=\begin{pmatrix}\ast&\ast&\ast&\ast\\&\ast&\ast&\ast\\&\ast&\ast&\ast\\&\ast&\ast&\ast\end{pmatrix}\]
则$\mathbf{A}^{(1)}=\mathbf{L}_1\mathbf{A}^{(0)}$，其中$L_1=\begin{pmatrix}1&0&\cdots&0\\-l_{21}&1&\cdots&0\\\vdots&\vdots&\ddots&\vdots\\-l_{n1}&0&\cdots&1\end{pmatrix}$。按此方式依次变换得
\[\mathbf{A}^{(n)}=\mathbf{L}_n\mathbf{A}^{(n-1)}=\cdots=\mathbf{L}_n\mathbf{L}_{n-1}\cdots\mathbf{L}_2\mathbf{L}_1\mathbf{A}^{(0)}\]
反推得到
\[\mathbf{A}=\mathbf{L}_1^{-1}\mathbf{L}_2^{-1}\cdots\mathbf{L}_{n-1}^{-1}\mathbf{A}^{(n-1)}\]
记$\mathbf{U}=\mathbf{A}^{(n-1)}$，则$\mathbf{A}=\mathbf{L}_1^{-1}\mathbf{L}_2^{-1}\cdots\mathbf{L}_{n-1}^{-1}\mathbf{U}=\mathbf{LU}$。

\trm 设$\mathbf{A}$为$n$阶矩阵，$D_k\neq0$，则$\mathbf{A}$可唯一分解为一单位下三角阵$\mathbf{L}$与一上三角阵$\mathbf{U}$之积
\begin{equation}\label{2-e1}
\mathbf{A}=\mathbf{LU}
\end{equation}
称为\textbf{LU分解}（Doolittle分解）。

% 此处缺少 L 与 U 的元素表示。

\entry LU分解的算法实现：根据式(\ref{2-e1})可知，$\mathbf{A}$中的元素$a_{ij}$满足
\begin{align*}
a_{ij}&=(l_{i1}\ l_{i2}\ \cdots\ l_{i,i-1}\ 1\ 0\ \cdots\ 0)\cdot(\mu_{1j}\ \mu_{2j}\ \cdots\ \mu_{jj}\ 0\ \cdots\ 0)^{\mathrm{T}}\\
&=\begin{cases}\sum\limits_{k=1}^{i-1}l_{ik}\mu_{kj}+\mu_{ij}&,j\geq i,\ i=1,2,\cdots,n\\\sum\limits_{k=1}^jl_{ik}\mu_{kj}&,j<i,\ i=1,2,\cdots,n\end{cases}
\end{align*}
由此可以推得迭代算式为：
\begin{align}
&\mu_{1j}=a_{1j}&j=1,2,\cdots,n\label{2-e2}\\
&l_{i1}=a_{i1}/\mu_{11}&i=2,3,\cdots,n\label{2-e3}\\
&\mu_{ij}=a_{ij}-\sum\limits_{k=1}^{i-1}l_{ik}\mu_{kj}&j=i,i+1,\cdots,n\ i=2,3,\cdots,n\label{2-e4}\\
&l_{ki}=(a_{ki}-\sum\limits_{t=1}^{i-1}l_{kt}\mu_{ti})/\mu_{ii}&k=i+1,\cdots,n\ i=2,3,\cdots,n\label{2-e5}
\end{align}

\entry 实用算法：
\begin{enumerate}\tl
    \item 照抄\footnote{即利用式(\ref{2-e2})。}系数矩阵$\mathbf{A}$第$1$行；
    \item 用式(\ref{2-e3})写出第$1$列；
    \item 用式(\ref{2-e4})写出第$2$行；
    \item 用式(\ref{2-e5})写出第$2$列；
    \item 重复应用式(\ref{2-e4})、式(\ref{2-e5})，生成行与列。
    \item 分成$\mathbf{L}$、$\mathbf{U}$两矩阵。
\end{enumerate}

\begin{gather*}
    \begin{pmatrix}a_{11}&a_{12}&\cdots&a_{1n}\\&&&\\&&&\\&&&\end{pmatrix}\sothat
    \begin{pmatrix}\mu_{11}&\mu_{12}&\cdots&\mu_{1n}\\l_{21}&&&\\\vdots&&&\\l_{n1}&&&\end{pmatrix}\sothat
    \begin{pmatrix}\mu_{11}&\mu_{12}&\cdots&\mu_{1n}\\l_{21}&\mu_{22}&\cdots&\mu_{2n}\\\vdots&&&\\l_{n1}&&&\end{pmatrix}\\
    \ \overset{\cdots\ }{\Rightarrow}\ 
    \begin{pmatrix}\mu_{11}&\mu_{12}&\cdots&\mu_{1n}\\l_{21}&\mu_{22}&\cdots&\mu_{2n}\\\vdots&\vdots&&\vdots\\l_{n1}&l_{n2}&\cdots&\mu_{nn}\end{pmatrix}=\mathbf{L}+\mathbf{U}=
    \begin{pmatrix}&&&\\l_{21}&&&\\\vdots&\vdots&&\\l_{n1}&l_{n2}&\cdots&\end{pmatrix}+
    \begin{pmatrix}\mu_{11}&\mu_{12}&\cdots&\mu_{1n}\\&\mu_{22}&\cdots&\mu_{2n}\\&&\ddots&\vdots\\&&&\mu_{nn}\end{pmatrix}
\end{gather*}

\entry 需注意：重复第5步时，有如下的小妙招。
\begin{enumerate}\tl
    \item 我们注意到，按此方法生成的顺序如左下图所示，为「┌」状的生成顺序。那么我们以第$k$步时的生成为例。
    \item 在第$k$步生成行时，对第$k$步的行的某个元素，首先向上找，应该能找到$k-1$个元素的列向量；再向左找，能找到一个$k-1$个元素的行向量，则该处应生成的值即为矩阵$\mathbf{A}$对应位置的元素值减去找到的两个向量的内积。
    \item 类似的，在第$k$步生成时，先向左找$k-1$个元素的行向量，再向上找$k-1$个元素的列向量，生成值为矩阵$\mathbf{A}$对应位置元素值减两向量内积之后\textbf{除以}$\mu_{kk}$。
    \item \emph{千万不要忘记生成列时要除以$\mu_{kk}$！！！}
\end{enumerate}


\example 分解矩阵$\mathbf{LU}$，其中：$\mathbf{A}=\begin{pmatrix}4&-2&0&4\\-2&2&-3&1\\0&-3&13&-7\\4&1&-7&23\end{pmatrix}$

（答案：$\mathbf{L}=\begin{pmatrix}1&&&\\-\frac12&1&&\\0&-3&1&\\1&3&\frac12&1\end{pmatrix},\mathbf{U}=\begin{pmatrix}4&-2&0&4\\&1&-3&3\\&&4&2\\&&&9\end{pmatrix}$）


\entry 利用LU分解可解线性方程组：
\[\mathbf{Ax=b}\sothat\mathbf{LUx=b}\sothat
\begin{cases}\mathbf{Ux=y}\\\mathbf{Ly=b}\end{cases}\]
转化为两个对角阵方程，易于求解。

\entry 平方根法和改进平方根法。

\entry LDU分解：令$\mathbf{D}=\diag(\mu_{11},\mu_{22},\cdots,\mu_{nn})$，则有：
\[\mathbf{A}=\mathbf{LU}=\mathbf{L\cdot I\cdot U}=\mathbf{LDD}^{-1}\mathbf{U}=\mathbf{LDM}^{\mathrm{T}}\]
其中$\mathbf{M}^{\mathrm{T}}=\mathbf{D}^{-1}\mathbf{U}$，$\mathbf{M}^{\mathrm{T}}$是一单位上三角阵。则：
\begin{equation}
\mathbf{M}=\begin{pmatrix}1&&&\\m_{21}&1&&\\\vdots&\vdots&\ddots&\\m_{n1}&m_{n2}&\cdots&1\end{pmatrix},\ m_{ji}=\frac{\mu_{ij}}{\mu_{ii}}\text{\ （即每行元素除以排头元素）}
\end{equation}
称$\mathbf{A=LDM}^{\mathrm{T}}$为矩阵的LDU分解。

\entry 对于对称阵，可分解为：$\mathbf{A=LDL}^{\mathrm{T}}$（前提：各阶顺序主子式非$0$）

\entry 对于对称正定阵，$\mathbf{D}$的元素均非负（且对角线非$0$），$\mathbf{A}=\mathbf{GG}^{\mathrm{T}}$（Cholesky分解）

\entry LDU计算式不必死记，只需记住LU分解然后变换即可。

\entry 平方根法：$\mathbf{A=GG}^{
\mathrm{T}}\sothat\mathbf{Ax=b}\sothat\mathbf{GG}^{\mathrm{T}}\mathbf{x=b}\sothat\begin{cases}\mathbf{Gy=b}\sothat\text{解出}\mathbf{y}\\\mathbf{G}^{\mathrm{T}}\mathbf{x=y}\sothat\text{解出}\mathbf{x}\end{cases}$

\entry 改进平方根法：$\mathbf{A=LDL}^{\mathrm{T}}\sothat\mathbf{Ax=b}\sothat\mathbf{LDL}^{\mathrm{T}}\mathbf{x=b}\sothat\begin{cases}\mathbf{Ly=b}\sothat\text{解出}\mathbf{y}\\\mathbf{Dz=y}\sothat\text{解出}\mathbf{z}\\\mathbf{L}^{\mathrm{T}}\mathbf{x=b}\sothat\text{解出}\mathbf{x}\end{cases}$

\entry 稀疏矩阵：大量元素为$0$，非零元很少。
\begin{figure}[htbp]
\small\centering
\includegraphics[width=\defwidth]{default.png}
\caption{稀疏矩阵做LU分解示意图}\label{2-f2}
\end{figure}
$p=q=1$时的带状矩阵称为三对角阵，通常为严格对角占优矩阵。

\entry 解三对角系数矩阵线性方程组的追赶法：设系数矩阵$\mathbf{T}$为三对角阵，则有
\[\mathbf{T=LU},\mathbf{Tx=d}\sothat\mathbf{LUx=d}\sothat\begin{cases}\mathbf{Ly=d}&\text{（追）}\\\mathbf{Ux=y}&\text{（赶）}\end{cases}\]


\section{病态问题理论}

\entry 残向量：$\mathbf{r=b-A}\tilde{\mathbf{x}}$

\entry 误差向量：$\mathbf{e=x^{\ast}}-\tilde{\mathbf{x}}$

\entry 如何衡量误差（向量）的大小？可采用向量的范数衡量。

\entry 向量范数：称$\|\mathbf{x}\|$为一个向量的范数，若$\|\mathbf{x}\|\in\mathbb{R}$满足：
\begin{enumerate}\tl
    \item 非负性：$\forall \mathbf{x}\in\mathbb{R}^n,\|\mathbf{x}\|\geq0\text{且}\|\mathbf{x}\|=0$ $\Leftrightarrow$ $\mathbf{x=0}$
    \item 齐次性：$\forall\alpha\in\mathbb{R},x\in\mathbb{R}^n,\|\alpha\mathbf{x}\|=|\alpha|\cdot\|\mathbf{x}\|$
    \item 三角不等式：$\forall\mathbf{x,y}\in\mathbb{R}^n,\|\mathbf{x+y}\|\leq\|\mathbf{x}\|+\|\mathbf{y}\|$
\end{enumerate}

\entry 常用范数：
\begin{itemize}\tl
    \item $1$-范数：$\|\mathbf{x}\|_1=|x_1|+|x_2|+\cdots+|x_n|.$
    \item $2$-范数：$\|\mathbf{x}\|_2=\sqrt{x_1^2+x_2^2+\cdots+x_n^2}.$
    \item $\infty$-范数：$\|\mathbf{x}\|_{\infty}=\max\limits_{1\leq i\leq n}|x_i|.$
\end{itemize}

\entry 矩阵范数：称$\|\mathbf{A}\|\in\mathbb{R}$为一个矩阵范数，若其满足：
\begin{enumerate}\tl
    \item 非负性：$\forall\mathbf{A},\|\mathbf{A}\|\geq0$且$\|\mathbf{A}\|=0\ \Leftrightarrow\ \mathbf{A=O}$
    \item 齐次性：$\forall\alpha\in\mathbb{R},\|\alpha\mathbf{A}\|=|\alpha|\cdot\|\mathbf{A}\|$
    \item 三角不等式：$\|\mathbf{A+B}\|\leq\|\mathbf{A}\|+\|\mathbf{B}\|$
    \item $\|\mathbf{AB}\|\leq\|\mathbf{A}\|\cdot\|\mathbf{B}\|$
\end{enumerate}

\entry 定义：若$\|\mathbf{Ax}\|\leq\|\mathbf{A}\|\cdot\|\mathbf{x}\|$，则称矩阵范数$\|\mathbf{A}\|$与向量范数$\|\mathbf{x}\|$为相容或协调的。

\entry 算子范数：$\|\mathbf{A}\|_p=\max\dfrac{\|\mathbf{Ax}\|_p}{\|\mathbf{x}\|_p}=\max\limits_{\|\mathbf{x}\|_p=1}\|\mathbf{Ax}\|_p$，容易证明$\|\mathbf{A}\|_p$满足相容条件。
\begin{enumerate}\tl
    \item $1$-范数：$\|\mathbf{A}\|_1=\max\limits_{1\leq j\leq n}\left\{\sum\limits_{i=1}^n|a_{ij}|\right\}$即列和最大值
    \item $2$-范数：$\|\mathbf{A}\|_2=\sqrt{\mathbf{A}^{\mathrm{T}}\mathbf{A}\text{的最大特征值}}$
    \item $\infty$-范数：$\|\mathbf{A}\|_{\infty}=\max\limits_{1\leq i\leq n}\left\{\sum\limits_{j=1}^n|a_{ij}|\right\}$即行和最大值
\end{enumerate}

\entry 矩阵的谱半径：$\rho(\mathbf{A})=\max\limits_{1\leq i\leq n}|\lambda_i|$，性质：$\rho(\mathbf{A})\leq\|\mathbf{A}\|$

\entry 定理：设$\|\mathbf{B}\|\leq1$，则$\mathbf{I-B}$可逆，且
\begin{equation}
\|(\mathbf{I-B})^{-1}\|\leq\frac1{1-\|\mathbf{B}\|}
\end{equation}

\entry 舍入误差对解的影响：
\[\mathbf{r=b-A}\tilde{\mathbf{x}}\sothat\mathbf{A}\tilde{\mathbf{x}}=\mathbf{b-r}\neq\mathbf{b}\]
为分析舍入误差的相对水平，先分析误差向量的大小：
\[\mathbf{e}=\\\mathbf{A}^{-1}\mathbf{r}\sothat\|\mathbf{e}\|=\|\mathbf{A}^{-1}\mathbf{r}\|\leq\|\mathbf{A}^{-1}\|\cdot\|\mathbf{r}\|\]
由于$\mathbf{Ax}^{\ast}=\mathbf{b}$，故
\[\|\mathbf{b}\|=\|\mathbf{Ax}^{\ast}\|\leq\|\mathbf{A}\|\cdot\|\mathbf{x}^{\ast}\|\sothat\frac1{\|\mathbf{x}^{\ast}\|}\leq\frac{\|\mathbf{A}\|}{\|\mathbf{b}\|}\]
故相对误差水平$\dfrac{\|\mathbf{x}^{\ast}-\tilde{\mathbf{x}}\|}{\|\mathbf{x}^{\ast}\|}\leq\|\mathbf{A}\|\cdot\|\mathbf{A}^{-1}\|\cdot\dfrac{\|\mathbf{r}\|}{\|\mathbf{b}\|}$，其中的系数即可定义为矩阵的条件数$\cond(\mathbf{A})=\|\mathbf{A}\|\|\mathbf{A}^{-1}\|$

\entry 易知$\cond(\mathbf{A})>1$（$\|\mathbf{A}\|\|\mathbf{A}^{-1}\|\geq\|\mathbf{A\cdot A}^{-1}\|=1$）

\entry 残向量$\mathbf{r}$不能完全反映偏差水平，因$\mathbf{r}$小，$\mathbf{e}$也不一定小。

\entry 系数矩阵扰动对解的影响：
\[(\mathbf{A}+\Delta\mathbf{A})\mathbf{x=b}\sothat\mathbf{r=b-A}\tilde{\mathbf{x}}=\Delta\mathbf{A}\tilde{\mathbf{x}}\sothat\|\mathbf{r}\|\leq\|\Delta\mathbf{A}\|\|\tilde{\mathbf{x}}\|\]
可见若$\Delta\mathbf{A}$小，$\mathbf{r}$也小。故相对误差水平
\[\frac{\|\mathbf{x}^{\ast}-\tilde{\mathbf{x}}\|}{\mathbf{x}^{\ast}}\leq\cond(\mathbf{A})\frac{\|\mathbf{r}\|}{\|\mathbf{b}\|}\leq\cond(\mathbf{A})\cdot\frac{\|\tilde{\mathbf{x}}\|}{\|\mathbf{x}^{\ast}\|}\cdot\frac{\|\Delta\mathbf{A}\|}{\|\mathbf{A}\|}\]

\entry 共同影响：$(\mathbf{A}-\Delta\mathbf{A})(\mathbf{x}-\Delta\mathbf{x})=\mathbf{b}-\Delta\mathbf{b}$，当$\|\Delta\mathbf{A}\|\cdot\|\mathbf{A}^{-1}\|<1$时：
\begin{equation}
\frac{\|\mathbf{x}^{\ast}-\tilde{\mathbf{x}}\|}{\mathbf{x}^{\ast}}\leq\frac{\|\mathbf{A}^{-1}\|\cdot\|\mathbf{A}\|}{1-\|\mathbf{A}^{-1}\|\cdot\|\mathbf{A}\|\cdot\frac{\|\Delta\mathbf{A}\|}{\|\mathbf{A}\|}}\left(\frac{\|\Delta\mathbf{b}\|}{\|\mathbf{b}\|}+\frac{\|\Delta\mathbf{A}\|}{\|\mathbf{A}\|}\right)
\end{equation}
$\cond(\mathbf{A})$较大时，方程组为病态方程组；反之，$\cond(\mathbf{A})$较小时，方程组仍为良态方程组。

\entry $\cond(\mathbf{A})$的估计：
\[\mathbf{Ax=b}\sothat\mathbf{x=A}^{-1}\mathbf{b}\sothat\|\mathbf{x}\|\leq\|\mathbf{A}^{-1}\|\cdot\|\mathbf{b}\|\sothat\frac{\|\mathbf{x}\|}{\|\mathbf{b}\|}\leq\|\mathbf{A}^{-1}\|\]
随机选取$p$个向量$\mathbf{b}_1,\mathbf{b}_2,\cdots,\mathbf{b}_p$，解方程$\mathbf{Ax}^{(k)}=\mathbf{b}_k$，得到$\mathbf{x}^{(k)}$，由上面结论得到
\[\max_{1\leq k\leq p}\frac{\|\mathbf{x}^{(k)}\|}{\|\mathbf{b}_k\|}\leq\|\mathbf{A}^{-1}\|\]
故可近似认为：$\cond(\mathbf{A})\approx\|\mathbf{A}\|\cdot\max\limits_{1\leq k\leq p}\frac{\|\mathbf{x}^{(k)}\|}{\|\mathbf{b}_k\|}.$


\chapter{线性方程组迭代解法}
\section{迭代方法概要}


\entry 思想：$f(x^{\ast})=0\sothat\cdots\sothat x^{\ast}=\phi(x^{\ast})$，给出初值$x_0$和递推公式$x_{k+1}=\phi(x_k)$，假设$\{x_k\}$收敛，求极限——设$\lim\limits_{k\to\infty}x_k=x$，则有$x=\phi(x)$，从而必有$f(x)=0$。

\entry 向量序列收敛：$\mathbf{x}^{(k)}=(x_1^{(k)},x_2^{(k)},\cdots,x_n^{(k)})^{\mathrm{T}}$，若$\lim\limits_{k\to\infty}x_i^{(k)}=x_i^{\ast}$，则$\mathbf{x}^{(k)}\to\mathbf{x}^{\ast}\ (k\to\infty)$，记作$\lim\limits_{k\to\infty}\mathbf{x}^{(k)}=\mathbf{x}^{\ast}$。

\entry 矩阵序列收敛：$\mathbf{A}^{(k)}=(a_{ij}^{(k)})_{m\times n}$，若$\lim\limits_{k\to\infty}a_{ij}^{(k)}=a_{ij}$，则称$\mathbf{A}^{(k)}\to\mathbf{A}=(a_{ij})_{m\times n}$
\footnote{不用$\mathbf{A}^\ast$，是怕与伴随矩阵的符号弄混。——作者注}
，记作$\lim\limits_{k\to\infty}\mathbf{A}^{(k)}=\mathbf{A}$。

\entry 序列收敛定理：
\begin{itemize}\tl
    \item 对向量，$\mathbf{x}^{(k)}\to\mathbf{x}^\ast\ \Leftrightarrow\ \lim\limits_{k\to\infty}\|\mathbf{x}^\ast-\mathbf{x}^{(k)}\|=0$
    \item 对矩阵，$\mathbf{A}^{(k)}\to\mathbf{A}\ \Leftrightarrow\ \lim\limits_{k\to\infty}\|\mathbf{A}-\mathbf{A}^{(k)}\|=0$
\end{itemize}

\entry 定理：设$\mathbf{B}\in\mathbb{R}^{m\times n}$，则$\lim\limits_{k\to\infty}\mathbf{B}^k=0\ \Leftrightarrow\ \rho(\mathbf{B})<1$。

\entry 设$\mathbf{Ax=b}$，变形得$\mathbf{x=Bx+g}$，可构造迭代格式
\begin{equation}\label{3-e1}
    \mathbf{x}^{(k+1)}=\mathbf{Bx}^{(k)}+\mathbf{g}
\end{equation}
则$\mathbf{x}^\ast=\lim\limits_{k\to\infty}\mathbf{x}^{(k)}$满足$\mathbf{x}^\ast=\mathbf{Bx}^\ast+\mathbf{g}\sothat\mathbf{Ax}^\ast=\mathbf{b}$\ ，故可以通过(\ref{3-e1})式不断迭代以逼近方程的解。


\section{三种基本迭代法}

\entry \key{Jacobi迭代法}：以第$i$行为例，有：
\[a_{i1}x_1+a_{i2}x_2+\cdots+a_{ii}x_i+\cdots+a_{in}x_n=b_i\]
可解出
\begin{align}
x_i&=\frac1{a_{ii}}[b_i-(a_{i1}x_1+a_{i2}x_2+\cdots+a_{i,i-1}x_{i-1}+a_{i,i+1}x_{i+1}+\cdots+a_{in}x_n)]\notag\\
&=\frac1{a_{ii}}\left[b_i-\sum_{j=1,j\neq i}^na_{ij}x_j\right]
\end{align}
依上式即可构造Jacobi迭代格式：
\begin{equation}
x_i^{(k+1)}=\frac1{a_{ii}}\left[b_i-\sum_{j=1,j\neq i}^na_{ij}x_j^{(k)}\right]\quad(i=1,2,\cdots,n)
\end{equation}
按照$\mathbf{x=Bx+g}$的标准格式，整理成矩阵格式：
\begin{equation}
\begin{pmatrix}x_1\\x_2\\\vdots\\x_n\end{pmatrix}=\begin{pmatrix}0&-\frac{a_{12}}{a_{11}}&-\frac{a_{13}}{a_{11}}&\cdots&-\frac{a_{1n}}{a_{11}}\\-\frac{a_{21}}{a_{22}}&0&-\frac{a_{23}}{a_{22}}&\cdots&-\frac{a_{2n}}{a_{22}}\\\vdots&\vdots&\vdots&\ddots&\vdots\\-\frac{a_{n1}}{a_{nn}}&-\frac{a_{n2}}{a_{nn}}&-\frac{a_{n3}}{a_{nn}}&\cdots&0\end{pmatrix}\begin{pmatrix}x_1\\x_2\\\vdots\\x_n\end{pmatrix}+\begin{pmatrix}\frac{b_1}{a_{11}}\\\frac{b_2}{a_{22}}\\\vdots\\\frac{b_n}{a_{nn}}\end{pmatrix}
\end{equation}

\entry \key{Gauss-Seidel迭代法}：
\begin{equation}
\left\{
\begin{aligned}
x_1^{(k+1)}&=\frac1{a_{11}}(b_1-a_{12}x_2^{(k)}-a_{13}x_3^{(k)}-\cdots-a_{1n}x_n^{(k)})\\
x_2^{(k+1)}&=\frac1{a_{22}}(b_2-a_{21}\fbox{$x_1^{(k+1)}$}-a_{23}x_3^{(k)}-\cdots-a_{2n}x_n^{(k)})\\
x_3^{(k+1)}&=\frac1{a_{33}}(b_2-a_{31}\fbox{$x_1^{(k+1)}$}-a_{32}\fbox{$x_2^{(k+1)}$}-\cdots-a_{3n}x_n^{(k)})\\
\cdots&\cdots\\
x_n^{(k+1)}&=\frac1{a_{nn}}(b_2-a_{n1}\fbox{$x_1^{(k+1)}$}-a_{n2}\fbox{$x_2^{(k+1)}$}-\cdots-a_{n,n-1}\fbox{$x_{n-1}^{(k+1)}$})
\end{aligned}
\right.
\end{equation}
$\mathbf{x=Bx+g}$形式与Jacobi法相同，但区别在于进行下一步变量的迭代时采用了「新解」（即上式中用方框框出的部分）。

\entry \key{超松弛迭代法}：对Gauss-Seidel法的通用格式分析改写；若记每次迭代时的误差为$\mathbf{r_i^{(k+1)}}$，即
\[x_i^{(k+1)}=x_i^{(k)}+\frac1{a_{ii}}\left[b_i-\sum_{j=1}^{i-1}a_{ij}x_j^{(k+1)}-\sum_{j=i}^na_{ij}x_j^{(k)}\right]=x_i^{(k)}+\frac{r_i^{(k+1)}}{a_{ii}}\]
当$k\to\infty$时总有$r_i^{(k+1)}/a_{ii}\to0$，故可以乘一个系数$\omega$以加快收敛：
\[x_i^{(k+1)}=x_i^{(k)}+\frac\omega{a_{ii}}\left[b_i-\sum_{j=1}^{i-1}a_{ij}x_j^{(k+1)}-\sum_{j=i}^na_{ij}x_j^{(k)} \right] \]
整理得
\begin{equation}
x_i^{(k+1)}=(1-\omega)x_i^{(k)}+\frac\omega{a_{ii}}\left[b_i-\sum_{j=1}^{i-1}a_{ij}x_j^{(k+1)}-\sum_{j=i+1}^na_{ij}x_j^{(k)} \right]
\end{equation}
整体迭代格式：
\begin{equation}
\left\{
\begin{aligned}
x_1^{(k+1)}&=(1-\omega)x_1^{(k)}+\frac\omega{a_{11}}\left(b_1-a_{12}x_2^{(k)}-a_{13}x_3^{(k)}-\cdots-a_{1n}x_{11}^{(k)} \right)\\
x_2^{(k+1)}&=(1-\omega)x_2^{(k)}+\frac\omega{a_{11}}\left(b_2-a_{21}x_1^{(k+1)}-a_{23}x_3^{(k)}-\cdots-a_{2n}x_{11}^{(k)} \right)\\
\cdots&\cdots\\
x_n^{(k+1)}&=(1-\omega)x_n^{(k)}+\frac\omega{a_{n1}}\left(b_n-a_{n1}x_1^{(k+1)}-a_{n2}x_2^{(k+1)}-\cdots-a_{n,n-1}x_{11}^{(k+1)} \right)
\end{aligned}
\right.
\end{equation}

\entry 迭代的矩阵表示法：将$\mathbf{A}$分解为$\mathbf{D,E,F}$三部分：$\mathbf{A=D-E-F}$，其中
\begin{equation}
\mathbf{D}=\left(\begin{smallmatrix}a_{11}&&&\\&a_{22}&&\\&&\ddots&\\&&&a_{nn}\end{smallmatrix}\right),\quad\mathbf{E}=\left(\begin{smallmatrix}0&&&&&\\-a_{21}&0&&&\\-a_{31}&-a_{32}&0&&\\\vdots&\vdots&\vdots&\ddots&\\-a_{n1}&-a_{n2}&-a_{n3}&\cdots&0 \end{smallmatrix}\right),\quad\mathbf{F}=\left(\begin{smallmatrix}0&-a_{12}&-a_{13}&\cdots&-a_{1n}\\&0&-a_{23}&\cdots&-a_{2n}\\&&0&\cdots&-a_{3n}\\&&&\ddots&\vdots\\&&&&0 \end{smallmatrix}\right)
\end{equation}
\begin{itemize}\tl
    \item Jacobi法：用矩阵形式推导Jacobi迭代公式，有
    \[\mathbf{(D-E-F)x=b}\sothat\mathbf{Dx=(E+F)x+b}\sothat\mathbf{x=D}^{-1}\mathbf{(E+F)x+D}^{-1}\mathbf{b}\]
    可见有
    \begin{equation}
    \begin{cases}\mathbf{B=D}^{-1}\mathbf{(E+F)=D}^{-1}(\mathbf{D-A})=\mathbf{I-D}^{-1}\mathbf{A}\\\mathbf{g=D}^{-1}\mathbf{b}\end{cases}
    \end{equation}
    \item Gauss-Seidel法：
    \[\mathbf{(D-E-F)x=b}\sothat\mathbf{(D-E)x=Fx+b}\sothat\mathbf{x=(D-E)}^{-1}\mathbf{Fx+(D-E)}^{-1}\mathbf{b}\]
    可见有
    \begin{equation}
    \begin{cases}
    \mathbf{B=(D-E)}^{-1}\mathbf{F}\\
    \mathbf{g=(D-E)}^{-1}\mathbf{b}
    \end{cases}
    \end{equation}
    \item SOR法：
    \begin{gather*}
    \omega\mathbf{(D-E-F)x}=\omega\mathbf{b}\sothat(\mathbf{D}-\omega\mathbf{E})\mathbf{x}=[(1-\omega)\mathbf{D}+\omega\mathbf{F}]\mathbf{x}+\omega\mathbf{b}\\
    \sothat\mathbf{x}=(\mathbf{D}-\omega\mathbf{E})^{-1}[(1-\omega)\mathbf{D}+\omega \mathbf{F}]\mathbf{x}+(\mathbf{D}-\omega\mathbf{E})^{-1}\omega\mathbf{b}
    \end{gather*}
    可见有
    \begin{equation}
    \begin{cases}
    \mathbf{B}=(\mathbf{D}-\omega\mathbf{R})^{-1}[(1-\omega)\mathbf{D}+\omega\mathbf{F}]\\
    \mathbf{g}=\omega(\mathbf{D}-\omega\mathbf{E})^{-1}\mathbf{b}
    \end{cases}
    \end{equation}
\end{itemize}



\section{迭代收敛理论}
\entry 下面给出迭代格式收敛的条件（非常重要！个人猜测必考）。

\entry 定理1：若$\|\mathbf{B}\|\leq1$，则$\forall\mathbf{x}^{(0)}$，迭代格式$\mathbf{x}^{(k+1)}=\mathbf{Bx}^{(k)}+\mathbf{g}$收敛于解$\mathbf{x}^\ast$，且有误差估计式：
\begin{gather}
\|\mathbf{x^\ast-x}^{(k)}\|\leq\frac{\|\mathbf{B}\|}{1-\|\mathbf{B}\|}\|\mathbf{x}^{(k)}-\mathbf{x}^{(k-1)}\|\quad\text{（事后估计）}\\
\|\mathbf{x}-\mathbf{x}^{(k)}\|\leq\frac{\|\mathbf{B}\|^k}{1-\|\mathbf{B}\|}\|\mathbf{x}^{(1)}-\mathbf{x}^{(0)}\|\quad\text{（事前估计）}
\end{gather}

\entry 定理2：$\forall\mathbf{x}^{(0)}$，迭代格式$\mathbf{x}^{(k+1)}=\mathbf{Bx}^{(k)}+\mathbf{g}$收敛于解$\mathbf{x}^\ast$的充要条件是下列两条件至少有一个成立：
\begin{enumerate}\tl
    \item $\mathbf{B}^k\to\mathbf{O}$；
    \item $\mathbf{B}$的谱半径$\rho(\mathbf{B})<1$。
\end{enumerate}

\entry 推论：SOR法收敛的必要条件是$0<\omega<2$。
\begin{gather*}
\|\mathbf{B}\|=\|(D-\omega\mathbf{E})^{-1}\|\cdot\|(1-\omega)\mathbf{D}+\omega\mathbf{F}\|=\frac{\|(1-\omega)\mathbf{D}\|}{\|\mathbf{D}\|}=(1-\omega)^n\\
\rho(\mathbf{B})<1\sothat|\lambda_1\cdots\lambda_n|<1\sothat|1-\omega|<1\sothat0<\omega<2.
\end{gather*}


\entry 对于三种常用迭代法，还有更为实用的结论可供应用：
\begin{itemize}\tl
    \item 引理：若$\mathbf{A}$是严格对角占优矩阵，$0\le\omega\leq1$且$\lambda\geq1$时，矩阵$(\lambda+\omega-1)\mathbf{D}-\lambda\omega\mathbf{E}-\omega\mathbf{F}$也是严格对角占优矩阵。
    \item 推论2：若$\mathbf{A}$是严格对角占优矩阵，则$\forall\mathbf{x}^{(0)}$，Jacobi法、G-S法、SOR法（$0<\omega\leq1$）均收敛
    \footnote{可由其上的引理推出：通过反设$|\lambda|\geq1$推出$|\lambda\mathbf{I-B}|\neq0$，故$|\lambda|<1$，$\rho(\mathbf{B})<1$。}
    。
    \item 推论3：若$\mathbf{A}$为对称正定阵，则$\forall\mathbf{x}^{(0)}$，Jacobi法收敛的充要条件是：$2\mathbf{D-A}$也是对称正定阵。
    \item 推论4：若$\mathbf{A}$是对称正定阵，则$\forall\mathbf{x}^{(0)}$，SOR法收敛充要条件为$0<\omega<2$。
\end{itemize}

\entry 对不同情况下的审敛法做总结：
\begin{enumerate}\tl
    \item 对角占优矩阵$\mathbf{A}$：Jacobi法收敛，G-S法收敛，$0<\omega\leq1$时SOR法收敛。
    \item 对称正定阵$\mathbf{A}$：
    \begin{itemize}\tl
        \item Jacobi法收敛$\ \Leftrightarrow\ 2\mathbf{D-A}$收敛；
        \item SOR法收敛$\ \Leftrightarrow\ 0<\omega<2$。
    \end{itemize}
    \item 一般矩阵$\mathbf{A}$：
    \begin{itemize}\tl
        \item $\|\mathbf{B}\|<1$时三方法均收敛；
        \item $\mathbf{B}^k\to\mathbf{O}$和$\rho(B)<1$中之一成立，则三方法均收敛。
        \item SOR法收敛的必要条件是$0<\omega<2$。
    \end{itemize}
\end{enumerate}

\example 判断系数矩阵为$\mathbf{A}=\begin{pmatrix}2&3&4\\3&6&10\\4&10&20\end{pmatrix}$时各迭代法的收敛性。

\chapter{插值法}
\section{插值法思想概要}
\entry 插值的动机：
\begin{enumerate}
    \item 离散型：给定$m+1$个数据点$(x_0,y_0)$、$(x_1,y_1)$、……$(x_m,y_m)$，找到一个函数$P(x)$通过所有的点。
    \item 连续型：给定一未知函数$f(x)$及其$m+1$个数据点，要求另一已知函数$P(x)$在这
    些数据点上与$f(x)$一致，并使其在定义与上与$f(x)$的偏差尽量小。（称$f(x)$为\key{
    被插函数}。）
\end{enumerate}

\define 设以上的$P(x)$满足
\begin{equation}\label{4-e1}
P(x_i)=y_i\quad(i=0,1,\cdots,m),
\end{equation}
则称$P(x)$为这$m+1$个数据点上的\key{插值函数}，称数据点为\key{插值点}，并称式
(\ref{4-e1})为\key{插值条件}。

\entry 多项式插值：要求插值函数$P(x)$为一个多项式
\begin{equation}
P(x)=\sum_{k=0}^na_kx^k=a_0+a_1x+\cdots+a_nx^n,
\end{equation}
则称此时的$P(x)$为一个\key{插值多项式}，对应的插值条件
\begin{equation}
P(x_i)=y_i\sothat a_0+a_1x_i+\cdots+a_ix_i^n=y_i\quad(i=0,1,\cdots,m)
\end{equation}
可视为一个线性方程组：
\begin{equation}\label{4-e2}
\begin{pmatrix}1&x_0&\cdots&x_0^n\\1&x_1&\cdots&x_1^n\\\vdots&\vdots&&\vdots\\
1&x_m&\cdots&x_m^n\end{pmatrix}\begin{pmatrix}a_0\\a_1\\\vdots\\a_n\end{pmatrix}
=\begin{pmatrix}y_0\\y_1\\\vdots\\y_n\\\end{pmatrix},
\end{equation}

\entry 关于方程组(\ref{4-e2})的解分析：
\begin{itemize}
    \item $m>n$，方程一般无解；
    \item $m<n$，方程有无穷多解；
    \item $m=n$时，系数矩阵对应的行列式是Van der monde行列式：
    \begin{equation}
    |V|=\prod_{j=1}^n\left[\prod_{i=0}^{j-1}(x_j-x_i)\right]
    \end{equation}
    当$x_i\neq x_j\ (i\neq j)$时，$|V|\neq0$，方程组有唯一解。
\end{itemize}

\trm 对于给定的$n+1$个插值点，对应的$n$次插值多项式$P_n(x)$唯一存在。

\entry 误差多项式：若被插函数$f(x)$满足$f^{(n)}(x)$在$[a,b]$上连续，$f^{(n+1)}$在
$(a,b)$内存在，则误差多项式可估计为
\begin{equation}
R_n(x)=f(x)-P_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)(x-x_1)\cdots(x-x_n).
\end{equation}
记
\begin{equation}
\pi_{n+1}(x)=(x-x_0)(x-x_1)\cdots(x-x_n),
\end{equation}
则有
\begin{equation}
R_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}\pi_{n+1}(x).
\end{equation}

\entry 实用误差估计式：设$P_n(x)$为在$x_0,x_1,\cdots,x_n$上的插值多项式，$P_n^\ast(x)$
为在$x_0,x_1,\cdots,x_n,x_{n+1}$上的插值多项式，则
\begin{gather}
f(x)-P_n(x)\approx\frac{P_n^\ast(x)-P_n(x)}{x_{n+1}-x_0}(x-x_0)\\
f(x)-P_n^\ast(x)\approx\frac{P_n^\ast(x)-P_n(x)}{x_{n+1}-x_0}(x-x_{n+1})
\end{gather}

\entry 采用式(\ref{4-e2})求解插值多项式的问题：方程条件数随$n$的增加而急剧上升，解不
稳定、不精确；计算量太大。

\section{Lagrange 插值法}
\entry Lagrange 插值法思想：对$n+1$个数据点，构造对应的$n+1$个\key{Lagrange插值基函
数}$l_0(x),l_1(x),\cdots,l_n(x)$使
\begin{equation}\label{4-e3}
P_n(x)=y_0\cdot l_0(x)+y_1\cdot l_1(x)+\cdots+y_n\cdot l_n(x).
\end{equation}

\entry 插值基函数的形式：由式(\ref{4-e3})易知插值基函数应在数据点上满足
\begin{equation}
l_i(x_j)=\delta_{ij}=\begin{cases}1&,i=j\\0&,i\neq j\end{cases}
\end{equation}
又要求插值基函数为$n$次多项式（与最终插值多项式的次数一致），则可解出
\begin{gather}
l_i(x)=\frac{(x-x_0)(x-x_1)\cdots(x-x_{i-1})(x-x_{i+1})\cdots(x-x_n)}{(x_i-x_0)
(x_i-x_1)\cdots(x_i-x_{i-1})(x-x_{i+1})\cdots(x_i-x_n)}.
\end{gather}
此即Lagrange插值基函数公式。由于其分母$\pi_{n+1}(x)/(x-x_i)$可直接写出，故只需计算
插值基函数的系数
\begin{equation}
c_i=\left[(x-x_0)(x-x_1)\cdots(x-x_{i-1})(x-x_{i+1})\cdots(x-x_n)\right]^{-1}.
\end{equation}

\example 给定数据点$(-1,7)$、$(1,7)$、$(2,4)$、$(5,35)$，用Lagrange插值法求解各插值
基函数的系数。（答案：$c_0=-\frac1{36}$，$c_1=\frac18$，$c_2=-\frac19$，
$c_3=\frac1{72}$。）

\entry 常将Lagrange基函数记为
\begin{equation}
l_i(x)=\frac{\pi_{n+1}(x)}{(x-x_i)\pi'_{n+1}(x_i)}.
\end{equation}

\entry Lagrange插值法的特点：构造方便、格式统一；系数的计算方法简单，但乘除运算量大；
插值基函数具有全局性质，「牵一发而动全身」，数据点变动后须全部重新计算。

% P140 4.10：Lagrange 基函数的性质

\section{Newton 插值法}
\entry Newton 插值法思想：对$n+1$个数据点，采用「累进」的插值基函数
\begin{equation}
n_i(x)=\prod_{k=0}^{i-1}(x-x_k)=(x-x_0)(x-x_1)\cdots(x-x_{i-1}),
\end{equation}
构造得到的 \key{Newton 插值多项式}为
\begin{equation}\label{4-e4}
N_n(x)=c_0+c_1(x-x_0)+c_2(x-x_0)(x-x_1)+\cdots+c_n(x-x_0)(x-x_1)\cdots(x-x_n),
\end{equation}
再求解系数$c_i$。

\entry \key{差商}：导数的一种离散形式，递归定义：
\begin{itemize}
    \item 零阶差商：$f[x_i]=f(x_i)=y_i\quad(i=0,1,\cdots,n)$.
    \item 一阶差商：$f[x_i,x_{i+1}]=\frac{f[x_{i+1}]-f[x_i]}{x_{i+1}-x_i}\quad
    (i=0,1,\cdots,n-1)$.
    \item 二阶差商：$f[x_i,x_{i+1},x_{i+2}]=\frac{f[x_i,x_{i+2}]-f[x_i,x_{i+1}]}{
    x_{i+2}-x_{i+1}}\quad(i=0,1,\cdots,n-2)$.
    \item ……
    \item $n$阶差商：$f[x_0,x_1,\cdots,x_n]=\frac{f[x_0,x_1,\cdots,x_{n-2},x_n]-
    f[x_0,x_1,\cdots,x_{n-2},x_{n-1}]}{x_n-x_{n-1}}$.
\end{itemize}

\entry 易证式(\ref{4-e4})中系数满足$c_0=f[x_0]$，$c_1=f[x_0,x_1]$，$c_2=f[x_0,x_1,
x_2]$……从而 Newton 插值多项式为
\begin{equation}
N_n(x)=\sum_{k=0}^nf[x_0,\cdots,x_k]\cdot n_k(x).
\end{equation}

\entry 由插值多项式的唯一性，对同样的$n+1$个数据点构造的 Lagrange 插值多项式$P_n(x)$
与 Newton 插值多项式$N_n(x)$，必有$P_n(x)=N_n(x)$，即两种方法得到的结果相同。

\trm 推论：比较 Newton 插值多项式与 Lagrange 插值多项式的最高次（$n$次）项系数，有
\begin{equation}
f[x_0,x_1,\ldots,x_n]=\sum_{i=0}^n\frac{f(x_i)}{\pi'_{n+1}(x_i)}.
\end{equation}

\trm 差商的性质：
\begin{enumerate}
    \item 差商仅与选取的具体点$(x_i,f(x_i))$有关，与它们的排列次序无关。
    \item $f[x_i,x_{i+1},\ldots,x_{i+k}]=f^{(k)}(\xi)/(k!)$，其中$\xi\in(\min\{x_i
    \},\max\{x_i\})$。
    \item 在以上结论中取$x_i=x_{i+1}=\ldots=x_{i+k}$，得
    \begin{equation}\label{4-e5}
    f[x_i,x_i,\ldots,x_i]=\frac{f^{(k)}(x_i)}{k!}.
    \end{equation}
    \item $\frac{\di f[x_0,x_1,\ldots,x_{k-1},x]}{\di x}=\frac{f^{(k+1)}(\xi)}{
    (k+1)!}$。
\end{enumerate}

\example 设$f(x)=x^3+2px+5qx+c$，其中$p,q,c$均为实数。若$f[1,2,m]=0$，试求$f[0,1,m]$。
（答案：$-2$）

\entry \key{差商表}：依次计算差商的工具。
\begin{figure}[htbp]
\small\centering
\includegraphics[width=\defwidth]{default.png}
\caption{差商表及其构造步骤}\label{4-f1}
\end{figure}

\entry Newton 插值法余项公式及估计：
\begin{align*}
R_n(x)&=f(x)-N_n(x)\\
&=f[x_0,x_1,\ldots,x_n,x](x-x_0)(x-x_1)\cdots(x-x_n)\\
&\approx f[x_0,x_1,\ldots,x_n,x_{n+1}](x-x_0)(x-x_1)\cdots(x-x_n)\\
&=N_{n+1}(x)-N_n(x)
\end{align*}
即:Newton 插值公式$N_n(x)$的余项，可估计为高一阶的插值多项式$N_{n+1}(x)$之最后一项。

\section{Hermite 插值多项式}
\entry Hermite 插值多项式：满足导数条件$P'(x_j)=y'_j$的插值多项式。

\entry Newton 插值法构造 Hermite 插值多项式（\key{重节点法}）：在含导数条件的数据点处
增加「重节点」，仍按差商表迭代，但利用条件(\ref{4-e5})计算含重节点的差商。
\begin{figure}[htbp]
\small\centering
\includegraphics[width=\defwidth]{default.png}
\caption{重节点法示意}\label{4-f2}
\end{figure}

\entry Hermite 插值多项式的误差估计：利用 Newton 插值公式的余项估计即可。

\example 对以下的数据点求解其 Hermite 插值多项式，并估计误差。
\begin{center}\begin{tabular}{cccc}
\toprule
$x_i$&$-1$&$0$&$1$\\
\midrule
$y_i$&$0$&$-4$&$5$\\
$y'_i$&&$0$&$5$\\
$y''_i$&$6$&&\\
\bottomrule
\end{tabular}\end{center}
（答案：$H_5(x)=x^5-2x^3+3x^2-4$，
$R_5(x)=\frac{f^{(6)}(\xi)}{6!}(x+1)(x-1)^2x^3$。）

\entry Lagrange 插值法构造 Hermite 插值多项式：对$n+1$个含带导数条件的数据点，在导数
条件下构造插值基函数$h_i(x)$与$\overline{h}_i(x)$：
\begin{gather}
H_{2n+1}(x)=\sum_{i=0}^nh_i(x)f(x_i)+\sum_{i=0}^n\overline{h}_i(x)f'(x_i)\\
h_i(x_j)=\delta_{ij},\quad h'_i(x_j)=0\quad\overline{h}_i(x_j)=0\quad
\overline{h'}_i(x_j)=\delta_{ij}.
\end{gather}
分析零点重数可推得
\begin{gather}
h_i(x)=(ax+b)l_i^2(x),\quad\overline{h}_i(x)=(x-x_i)l_i^2(x)
\end{gather}
再求解系数$a$与$b$即可。

\entry 不建议使用 Lagrange 插值法求解 Hermite 插值多项式：优势尽失。

\section{分段插值与三次样条插值}
\entry \key{Runge 现象}：采用高次的插值多项式，全局误差可能比低次多项式更大。

\entry Runge 现象示例：对函数$f(x)=\frac1{1+25x^2}\quad(-1\leq x\leq 1)$等距插值。

\entry Runge 现象表明，与其在全局应用高次插值多项式，不如采用分段低次插值多项式。

\entry 分段线性插值的误差估计：
\begin{equation}
R_{1,j}(x)=\left|\frac{f''(\xi)}2(x-x_{i-1})(x-x_i)\right|\leq\frac{M_2i}2\cdot
\frac14(x_i-x_{i-1})^2\leq\frac18M_2\Delta^2
\end{equation}
其中$M_2$为$f''(x)$在插值区间上的最大值，$\Delta$为各相邻插值节点的最大距离。

\begin{figure}[htbp]
\small\centering
\includegraphics[width=\defwidth]{default.png}
\caption{分段线性插值图示}\label{4-f3}
\end{figure}

\entry 分段线性插值的缺陷：在各个节点处导数不连续。

\entry 分段二次插值：在$[x_{i-1},x_{i+1}]$上作 Newton 二次插值多项式$N_{2i}(x)$，则
\begin{equation}
f(x)\approx N_{2i}(x)=y_{i-1}+f[x_{i-1},x_i](x-x_{i-1})+f[x_{i-1},x_i,x_{i+1}]
(x-x_{i-1})(x-x_i).
\end{equation}

\entry 分段二次插值的误差估计：
\begin{equation}
R_{2i}(x)=\frac{f'''(\xi)}{3!}(x-x_{i-1})(x-x_i)(x-x_{i+1})\leq\frac{M_3}6\cdot
\frac14\Delta^2\cdot2\Delta=\frac1{12}M_3\Delta^3
\end{equation}
其中$M_3$为$f'''(x)$在插值区间上的最大值，$\Delta$为各相邻插值节点的最大距离。

\entry 分段二次插值的缺陷：在一半的节点上导数仍不连续；要求有偶数个插值节点。

\begin{figure}[htbp]
\small\centering
\includegraphics[width=\defwidth]{default.png}
\caption{分段二次插值图示}\label{4-f4}
\end{figure}

\entry 分段三次 Hermite 插值：在相邻插值节点处利用两个函数值、两个导数值构造插值多项式。

\entry 分段三次 Hermite 插值的误差估计：
\begin{equation}
R_{3,i}(x)=\frac{f^{(4)}(\xi)}{4!}(x-x_{i-1})^2(x-x_i)^2\leq\frac{M_4}{24}
\left[\frac14(x-x_{i-1})^2\right]^2\leq\frac{M_4}{384}\Delta^4.
\end{equation}

\entry 分段三次 Hermite 插值的缺陷：二阶导数仍不连续；导数条件太苛刻，不一定能得到。

\entry \key{三次样条插值}：给定$n+1$个数据点，要求分段插值曲线的二阶导数连续。
由此可知，插值函数及其导数也应连续。此时：
\begin{itemize}
    \item 需求：在$n$个插值子区间上构造三次插值函数，共计$4n$个未知数；
    \item 约束条件：$n+1$个数据点，$3(n-1)$个各阶导数连续条件，共计$4n-2$个方程；
    \item 补充两个边界条件：一阶导数边界条件$f'(a)$、$f'(b)$，或二阶导数边界条件
    $f'(a)$、$f'(b)$，或周期性边界条件$f'(a)=f'(b)$、$f''(a)=f''(b)$。
\end{itemize}
由此即可求解出所有的分段三次插值函数，称这些函数为\key{三次样条函数}。

\entry \key{三弯矩方程}

\entry \key{三次样条插值的误差估计}

\chapter{函数最优逼近}
\entry 逼近与插值的区别：插值要求通过数据点，逼近则不要求；逼近追求整个区间或所有取值点
上的总体误差最小。

\entry 用多项式逼近：便于计算，便于做微积分。

\section{内积、范数与正交多项式}
\define \setkey{函数在点集上的内积}{函数内积（点集）}：设$f(x)$，$g(x)$在$X=\{x_1,x_2,
\ldots,x_m\}$上有定义，并有相应的$m$个权系数$\omega_i$，则定义
\[(f,g)=\sum_{i=1}^m\omega_if(x_i)g(x_i)\]
为$f$与$g$在$X$上关于权系数$\omega_i$的内积。

\define \setkey{函数在区间上的内积}{函数内积（区间）}：设$f,g\in C[a,b]$，$\omega(x)
\in C[a,b]$为权系数，定义
\[(f,g)=\int_a^b\omega(x)f(x)g(x)\di x\]
为$f$与$g$在$[a,b]$上关于$\omega(x)$的内积。

\entry 对权系数的要求：$\omega_i>0$或$\omega(x)\geq0$。常取$\omega_i=1$及
$\omega(x)\equiv1$。

\trm 内积的性质：
\begin{enumerate}
    \item （对称性）$(f,g)=(g,f)$。
    \item （齐性）对任意的常数$\alpha$，$(\alpha f,g)=(f,\alpha g)=\alpha\cdot(f,g)$。
    \item （可加性）$(f+h,g)=(f,g)+(h,g)$。
    \item （正定性）$(f,f)\geq0$，且仅当$f\equiv0$时$(f,f)=0$。
\end{enumerate}

\define \setkey{函数在点集或区间上的范数}{函数范数}：对点集$X$上所有函数，或对区间上
所有连续函数$C[a,b]$定义的运算$\|f\|$，满足：
\begin{enumerate}
    \item （正定性）$\|f\|\geq0$，且仅当$f\equiv0$时$\|f\|=0$。
    \item （线性）对任意的常数$\alpha$，$\|\alpha f\|=|\alpha|\cdot\|f\|$。
    \item （三角不等式）$\|f+g\|\leq\|f\|+\|g\|$。
\end{enumerate}

\entry 常用范数：
\begin{itemize}
    \item 由函数内积导出的$2$-范数：$\|f(x)\|_2=\sqrt{(f,f)}$。
    \item $1$-范数：$\|f\|_1=\sum_{i=1}^m|f(x_i)|$或$\|f\|_1=\int_a^b|f(x)|\di x$。
    \item $\infty$-范数：$\|f\|_\infty=\max\limits_{1\leq i\leq m}|f(x_i)|$或
    $\|f\|_\infty=\max\limits_{a\leq x\leq b}|f(x)|$。
\end{itemize}

\entry 函数的\key{正交}：
\begin{itemize}
    \item 在权函数$\omega_i$（或$\omega(x)$）下，若$(f,g)=0$，则称两函数关于权函数
    $\omega_i$（或$\omega(x)$）正交，称$f$与$g$为\key{正交函数}。
    \item 设有函数族$\{g_k\}$，若其中各函数$g_0(x),g_1(x),\cdots,g_k(x),\cdots$满足
    $(g_i,g_j)=0\,(i\neq j)$，则称$\{g_k\}$为关于$\omega$\setkey{正交}{正交函数族}的函数族。
    \item 若正交函数族$\{g_k\}$进一步满足$\|g_i(x)\|=1\,(\forall i)$，则称其为一个
    \key{标准正交函数族}。
    \item 若正交函数族$\{g_k\}$中的$g_k(x)$为$k$次多项式，则称$g_0(x),\cdots,g_k(x),
    \cdots$为\key{正交多项式}。
\end{itemize}

\trm 正交多项式基本性质：各正交多项式之间线性无关。（证明：利用正交性与正定性。）

\trm 推论 1：设$k<n$，则$k$次多项式$P_k(x)$必与$n$次正交多项式$g_n(x)$正交。
（证明：$P_k(x)$可用$g_0(x),\cdots,g_k(x)$线性表出，进而由正交性得其与$g_n(x)$正交。）

\trm 推论 2：在区间$[a,b]$（连续）或$[\min x_i,\max x_i]$（离散）上，$n$次正交多项式
$g_n(x)$恰有$n$个不同实零点。（证明思路：有实根\sothat 无偶重根\sothat 均为实根\sothat
无多于$1$重的奇实根。）

\trm 推论 3：设$g_0(x),g_1(x),\cdots,g_k(x),\cdots$均为首一正交多项式，则
\begin{gather}
g_0(x)=1,\,g_1(x)=x-b_0,\,g_{k+1}(x)=(x-b_x)g_k(x)-c_kg_{k-1}(x)\label{5-e1}\\
b_k=\frac{\beta_k}{\gamma_k},c_k=\frac{\gamma_k}{\gamma_{k-1}},\beta_k=(xg_k,g_k),
\gamma_k=(g_k,g_k).\notag
\end{gather}
称此式为正交多项式的\key{三项递推关系}。

\entry 推论 3 的证明：

\entry \key{Legendre 多项式}：在区间$[-1,1]$上，定义
\begin{equation}
P_k(x)=\frac1{2^k\cdot k!}\frac{\di^k}{\di x^k}\left[(x^2-1)^k\right].\quad(k=0,
1,2,\ldots)
\end{equation}
其关于权函数$\omega(x)\equiv1$正交。最高次项系数为$\alpha_k=\frac{(2k)!}{2^k\cdot
(k!)}$。

\entry 其他常见正交多项式：
\begin{itemize}
    \item Laguerre 多项式：$L_k(x)=\e^x\frac{\di(x^k\e^{-x})}{\di x^k}$，正交区间
    为$[0,+\infty)$，权函数为$\omega(x)=\e^{-x}$。
    \item Hermite 多项式：$H_k(x)=(-1)^k\e^{x^2}\frac{\di^k\e^{-x^2}}{\di x^k}$，
    正交区间为$(-\infty,+\infty)$，权函数为$\omega(x)=\e^{-x^2}$。
    \item Cheybyshev 多项式：$T_k(x)=\cos(k\arccos x)$，正交区间为$[-1,1]$，权函数
    为$\omega(x)=\frac1{\sqrt{1-x^2}}$。
\end{itemize}

\section{最优平方逼近}
\entry 最优平方逼近：对函数$f(x)$，构造多项式$p(x)$使按$2$-范数度量得到的误差$S=
(\|p-f\|_2)^2$最小。

\entry 为系统地实现这一构造过程，常用一多项式函数族$\{\vphi_k(x)\}$表出：
\begin{equation}\label{5-e2}
    p(x)=c_0\vphi_0(x)+\cdots+c_n\vphi_n(x),
\end{equation}
从而问题落实为：
\begin{enumerate}
    \item 多项式族$\{\vphi_k(x)\}$的选取或导出；
    \item 系数$c_k$的求解。
\end{enumerate}

\define 若$f$为列表函数，则称逼近其的$p(x)$为\key{最小二乘拟合多项式}，误差表达式为
\[\|p-f\|_2=\sqrt{\sum_{i=1}^m\omega_i[p(x_i)-y_i]^2}.\]

\define 若$f$为连续函数，则称逼近其的$p(x)$为\key{最优平方逼近多项式}，误差为
\[\|p-f\|_2=\sqrt{\int_a^b(p-f)^2\di x}.\]

\entry \key{正规方程组}：按定义将$S=\|p-f\|_2^2$拆开：
\begin{gather}
S=(p-f,p-f)=(p,p)-2(p,f)+(f,f)\notag\\
S=\sum_{i=0}^nc_i\sum_{j=0}^nc_j(\vphi_i,\vphi_j)-2\sum_{i=0}^nc_i(\vphi_i,f)+
(f,f).\label{5-e3}
\end{gather}
视$S$为系数$c_0,\cdots,c_n$的函数，欲令$S$达到极小值，则令
\[\frac{\del S}{\del c_k}=2\sum_{i=0}^nc_j(\vphi_k,\vphi_j)-2(\vphi_k,f)=0\]
从而可得求解系数$c_i$的\key{正规方程组}
\begin{equation}
\sum_{i=0}^nc_j(\vphi_k,\vphi_j)=(\vphi_k,f)
\end{equation}
或
\begin{equation}\label{5-e4}
\begin{pmatrix}(\vphi_0,\vphi_0)&(\vphi_0,\vphi_1)&\cdots&(\vphi_0,\vphi_n)\\
(\vphi_1,\vphi_0)&(\vphi_1,\vphi_1)&\cdots&(\vphi_1,\vphi_n)\\
\vdots&\vdots&\ddots&\vdots\\
(\vphi_n,\vphi_0)&(\vphi_n,\vphi_1)&\cdots&(\vphi_n,\vphi_n)\end{pmatrix}
\begin{pmatrix}c_0\\c_1\\\vdots\\c_n\end{pmatrix}=
\begin{pmatrix}(\vphi_0,f)\\(\vphi_1,f)\\\vdots\\(\vphi_n,f)\end{pmatrix}.
\end{equation}

\entry 正规方程组中，系数矩阵为对称正定阵，有唯一解。故最优平方逼近的结果存在且唯一。

\entry 正规方程组可改写为
\begin{equation}
(\vphi_k,p-f)=0\quad(k=0,1,\ldots,n).
\end{equation}
意义：误差向量$(p-f)$在由有限个向量$\vphi_k$张成的空间下无投影，控制「低维误差」。

\entry 正规方程组解法 1：选取$\{\vphi_k\}$为一组正交多项式，则正规方程组简化为
\[(\vphi_k,\vphi_k)c_k=(\vphi_k,f),\]
从而易得$c_k=\frac{(\vphi_k,f)}{(\vphi_k,\vphi_k)}$，进而得逼近多项式为
\begin{equation}\label{5-e4.5}
P(x)=\sum_{k=0}^n\frac{(\vphi_k,f)}{(\vphi_k,\vphi_k)}\vphi_k(x).
\end{equation}

\entry 函数族$\vphi_k(x)$的选取原则：
\begin{enumerate}
    \item 直观性原则：观察$(x_i,y_i)$的分布，选取函数族。
    \item 比较性原则：对不同的函数族，可分别拟合，再比较它们的误差向量之大小
    \[\|p-f\|_2=\sqrt{\sum_{i=1}^m\omega_i[p(x_i)-y_i]^2}\]
    \item 根据实际问题背景选择函数族（如对周期性变化的函数，可用三角函数族）。
\end{enumerate}

\entry 离散的正规方程组（最小二乘法）：记
\begin{gather*}
G=\begin{pmatrix}\vphi_0(x_1)&\vphi_1(x_1)&\cdots&\vphi_n(x_1)\\
\vphi_0(x_2)&\vphi_1(x_2)&\cdots&\vphi_n(x_2)\\
\vdots&\vdots&\ddots&\vdots\\
\vphi_0(x_m)&\vphi_1(x_m)&\cdots&\vphi_n(x_m)\end{pmatrix},\,
W=\diag(\omega_1,\omega_2,\cdots,\omega_m),\\
y=(y_1\,y_2\,\cdots\,y_m)^T,\,c=(c_0\,c_2\,\cdots\,c_n)^T,
\end{gather*}
则原正规方程组化为
\begin{equation}\label{5-e5}
(G^TWG)c=(G^TW)y.
\end{equation}
特别地，若取$\omega_i=1$，则方程进一步简化为
\begin{equation}
G^TGc=G^Ty,
\end{equation}
此即最小二乘方程，具体形式为
\begin{equation}
\begin{pmatrix}\dsum_{i=1}^m1&\dsum_{i=1}^mx_i&\cdots&\dsum_{i=1}^mx_i^n\\
\dsum_{i=1}^mx_i&\dsum_{i=1}^mx_i^2&\cdots&\dsum_{i=1}^mx_i^{n+1}\\
\vdots&\vdots&\ddots&\vdots\\
\dsum_{i=1}^mx_i^n&\dsum_{i=1}^mx_i^{n+1}&\cdots&\dsum_{i=1}^mx_i^{2n}\end{pmatrix}
\begin{pmatrix}c_0\\c_1\\\vdots\\c_n\end{pmatrix}=
\begin{pmatrix}\dsum_{i=1}^my_i\\\dsum_{i=1}^mx_iy_i\\\vdots\\\dsum_{i=1}^mx_i^ny_i
\end{pmatrix}
\end{equation}

\entry 当$m=n+1$时，最小二乘拟合多项式即插值多项式。

\example 对于若干数据点$(x_i,y_i)$，欲采用$y=b\e^{ax}$进行拟合，其中$a,b$为待定常数；
可对该表达式取对数得
\[\ln y=\ln b+ax\]
再考虑误差函数
\[S(a,b)=\sum_{i=1}^m(\ln b+ax_i-\ln y_i)^2\]
令其对$a$、$b$的偏导数为$0$，即可解出参数值。

\entry 最小二乘拟合/最优平方逼近的一般方法：
\begin{enumerate}
    \item 可自选一组线性无关的基函数，求解正规方程组(\ref{5-e4})或(\ref{5-e5})。
    一般选取$\vphi_k(x)=x^k$。（难点在列、解方程）
    \item 可利用三项递推关系(\ref{5-e1})求解一族首一正交多项式$g_0(x),\cdots,g_n(x)$，
    利用式(\ref{5-e4.5})计算逼近的多项式。（难点在递推、计算内积。）
    \item 可先通过变量代换$x=\frac{a+b}2+\frac{b-a}2t$将区间$[a,b]$替换为$[-1,1]$，
    对变换后的函数$\overline{f}(t)$用正交的 Legendre 多项式求出$\overline{P}(t)$，
    最后用$t=\frac{2x-a-b}{b-a}$还原到$P(x)$。（难点在记 Legendre 多项式、展开和计算
    内积。）
\end{enumerate}

\example 求$y=\sqrt x$在$[0,1]$上最优平方逼近一次多项式。（答案：$p(x)=\frac45x+
\frac4{15}$。）
\begin{enumerate}
    \item 用$\vphi_0(x)=1$，$\vphi_1(x)=x$，可列出正规方程组
    \[
    \begin{pmatrix}1&1/2\\1/2&1/3\end{pmatrix}\begin{pmatrix}c_0\\c_1\end{pmatrix}
    =\begin{pmatrix}2/3\\2/5\end{pmatrix}
    \]
    容易求得$c_0=\frac45$，$c_1=\frac4{15}$，从而$p(x)=\frac45+\frac4{15}$。
    \item 用三项递推式，有$g_0(x)=1$，
    \begin{equation}
    g_1(x)=x-\frac{(x,1)}{(1,1)}=x-\frac12,
    \end{equation}
    故可进一步计算
    \begin{align*}
    (g_1,g_2)&=(x-\frac12,x-\frac12)=\int_0^1(x-\frac12)^2\di x=\frac1{12}\\
    (f,g_0)&=(\sqrt x,1)=\frac23\\
    (f,g_1)&=(\sqrt x,x)-(\sqrt x,\frac12)=\frac25-\frac12\cdot\frac23=
    \frac1{15},
    \end{align*}
    从而有
    \[p(x)=\frac23+\frac{1/15}{1/12}\cdot\left(x-\frac12\right)=\frac45x-\frac4{
    15}.\]
    \item 用 Legendre 多项式求解，为此先作变量代换$x=\frac12+\frac12t$，被插函数变为
    $\overline{f}(t)=\sqrt{\frac{1+t}2}$，进而可用前两个 Legendre 多项式
    \[P_0(t)=1,\,P_1(t)=t\]
    逼近$\overline{f}(t)$。可以计算各个内积为
    \begin{align*}
    (P_0,P_0)&=\int_{-1}^1\di t=2\\
    (P_1,P_1)&=\int_{-1}^1t^2\di t=\frac23\\
    (f,P_0)&=\int_{-1}^1\sqrt{\frac{1+t}2}=\frac{\sqrt2}2\int_{-1}^1\sqrt{1+t}
    \di(1+t)=\frac{\sqrt2}2\cdot\frac23\cdot(2\sqrt2)=\frac43\\
    (f,P_1)&=\int_{-1}^1\sqrt{\frac{1+t}2}=\frac{\sqrt2}2\int_{=1}^1(\sqrt{1+t})%
    ^3\di(1+t)-(f,P_0)\\
    &=\frac{\sqrt2}2\cdot\frac25\cdot(4\sqrt2)-\frac43=\frac4{15}
    \end{align*}
    从而
    \[\overline{p}(t)=\frac{4/3}2+\frac{4/15}{2/3}t=\frac23+\frac25t\]
    回代$t=2x-1$即得$p(x)=\frac45+\frac4{15}x$。
\end{enumerate}

\chapter{数值积分与数值微分}

\entry 常规积分的局限性：往往难以求得原函数，无法应用 Newton-Leibniz 公式；有时
仅知函数在个别离散点的取值。

\entry 数值积分/数值微分的共同思路：用个别点处函数值$f(x_i)$的线性组合，来估计整个区
间上的积分值或个别点附近的微分值。
\begin{gather}
\int_a^bf(x)\di x=\sum_{i=0}^nA_if(x_i)\\
f'(x)=\sum_{i=0}^nB_if(x_i)
\end{gather}

\entry 主要问题：
\begin{enumerate}
    \item 节点$x_i$的选取；
    \item 求积系数$A_k$的计算；
    \item 误差估计与评价。
\end{enumerate}

\entry 记号：对于$f(x)$，记其准确积分值为
\[I[f]=\int_a^bf(x)\di x\]
而记其数值估计公式为
\[Q[f]=\sum_{i=0}^nA_if(x_i)\approx I[f].\]
将数值积分公式的误差记为$R[f]=I[f]-Q[f]$

\section{插值型积分及其延伸}
\entry 两种近似积分思路：
\begin{enumerate}
    \item 按 Riemann 积分定义，作区间的划分，按若干小矩形估算：
    \[\int_a^bf(x)\di x\approx\sum_{i=o}^nf(x_i)(x_{i+1}-x_i)\]
    \item 取若干数据点插值，用插值多项式$p(x)$的积分估计函数的积分：
    \[\int_a^bf(x)\di x\approx\int_a^bp(x)\di x=\int_a^b\left[\sum_{i=0}^n
    l_i(x)f(x_i)\right]\di x=\sum_{i=0}^n\left(\int_a^bl_i(x)\di x\right)\cdot
    f(x_i).\]
\end{enumerate}
共同特点是：用若干点上函数值$f(x_i)$之线性组合估计整个区间上的积分值。问题：无法估计
误差。因此，应当从此种思路出发，直接构造估计公式，进而就可估计误差。

\entry \key{Newton-Cotes 型求积公式}：在区间上等距取定若干插值点，构造插值多项式并以
其积分代替$f(x)$的积分。

\entry 设节点数为$n+1$个（$x_0,x_1,\cdots,x_n$），一般常取$n=1,2,4$，记
此时各点的距离为$h=\frac{b-a}n$。

\entry \key{梯形公式}：当$n=1$时，取定区间的左右两端点为$x_0$与$x_1$，可得到
\begin{equation}
Q_1[f]=\frac{b-a}2\left[f(a)+f(b)\right].
\end{equation}
此即梯形求积公式，常将$Q_1[f]$记为$T_1$。。由广义积分中值定理
\footnote{设$f,g\in C[a,b]$且$g$在$[a,b]$不变号，则存在$\eta\in[a,b]$使
$\int_a^bf(x)g(x)\di x=f(\eta)\int_a^bg(x)\di x$。}
可估计误差为
\begin{equation}
R_1[f]=\frac{(b-a)^3}{12}f''(\eta),\,\eta\in(a,b)
\end{equation}

\entry \key{Simpson 公式}：当$n=2$时，$h=\frac{b-a}2$，将取得以下等距节点：
\[x_0=a,\,x_1=\frac{a+b}2,\,x_2=b.\]
作插值多项式并积分，可得求积公式为
\begin{equation}
Q_2[f]=\frac h3\left[f(a)+4f\left(\frac{a+b}2\right)+f(b).\right]
\end{equation}
此即 Simpson 公式，常将$Q_2[f]$简记为$S_1$。利用之后的结果可估计误差为
\begin{equation}
R_2[f]=-\frac{(b-a)^5}{2880}f^(4)(\eta).
\end{equation}

\entry \key{Cotes 求积公式}：当$n=4$时，$h=\frac{b-a}4$，插值并积分可得
\begin{equation}
Q_4[f]=\frac{b-a}{90}[7f(a)+32f(a+h)+12f(a+2h)+32f(a+3h)+7f(b).]
\end{equation}
此即 Cotes 求积公式，常将$Q_4[f]$简记为$C_1$。利用之后的结果可估计误差为
\begin{equation}
R_4[f]=-\frac{(b-a)^7}{1935360}f^{(6)}(\eta).
\end{equation}

\entry \key{代数精度}：设有一数值积分公式，$m$为一正整数。若对于不超过$m$次的多项式均
有$R[f]=0$成立，而对某$m+1$次多项式即有$R[f]\neq0$，则称该数值积分公式的代数精度为$m$。

\entry 对梯形公式，其代数精度为 $1$；对 Simpson 公式，其代数精度为 $2$；对 Cotes 公式，
其代数精度为 $4$。

\entry 不宜采用次数过高的多项式插值：Runge 现象
\footnote{且根据后面的内容可知，次数过高的 Newton-Cotes 公式稳定性差，结果易发散}。

\entry 复化求积公式：对每个小区间 $[x_{k-1},x_k]$ 分别运用积分公式，再将结果求和。

\entry 公式表述：对由 $n+1$ 个数据点所划分的 $n$ 个小区间，对以上三种插值型积分公式的
结果如下。
\begin{itemize}
    \item 取 $n=1$，得复化梯形公式
    \begin{equation}
    T_n=\frac h2\left[f(a)+2\dsum_{i=1}^{n-1}f(x_i)+f(b)\right],
    \end{equation}
    其误差估计为 $R_{T_n}=-\frac{b-a}{12}h^2f''(\eta)$。
    \item 取 $n=2$，得复化 Simpson 公式
    \begin{equation}
    S_n=\frac h2\left[f(a)+2\dsum_{i=1}^{n-1}f(x_i)+f(b)\right],
    \end{equation}
    其误差估计为 $R_{S_n}=-\frac{b-a}{2880}h^4f^{(4)}(\eta)$。
    \item 取 $n=4$，得复化 Cotes 公式
    \begin{equation}\begin{aligned}
    C_n=&\frac h{90}\left\{7f(a)+32\dsum_{i=0}^{n-1}\left[
    f\left(x_i+\frac h4\right)+f\left(x_i+\frac{3h}4\right)\right]+\right.\\
    &\left.12\dsum_{i=0}^{n-1}f\left(x_i+\frac h2\right)+14\dsum_{i=1}^{n-1}f(x_i)
    +7f(b)\right\}.
    \end{aligned}\end{equation}
    其误差估计为 $R_{c_n}=-\frac{b-a}{1935360}h^6f^{(6)}(\eta)$。
\end{itemize}

\entry 变步长积分法：为进一步减小误差，考虑在用复化求积公式时不断缩小步长。为此考虑先凑
出一个近似的误差估计式。设用复化梯形公式 $T_n$ 求积分，当取得 $n+1$ 个点时的误差估计式为
\begin{equation}
R_n[f]=I[f]-T_n=-\frac{b-a}{12}h^2f''(\eta_1)
\end{equation}
若将间隔数翻倍，则当取得 $2n+1$ 个点时的误差估计式为
\begin{equation}
R_{2n}[f]=I[f]-T_{2n}=-\frac{b-a}{12}\left(\frac h2\right)^2f''(\eta_2)
\end{equation}
若估计$f''(\eta_1)\approx f''(\eta_2)$，则联立两式即可得到
\begin{equation}\label{6-e1}
R_{2n}[f]=I[f]-T_{2n}\approx\frac13(T_{2n}-T_n)
\end{equation}
即积分误差可以用变步长结果间的差距 $T_{2n}-T_n$ 所估计。因此，若希望实现 $R[f]<
\vepsilon$，可按如下步骤实施变步长复化积分：
\begin{enumerate}
    \item $n=1$，$h=b-a$，计算$T_n$；
    \item 缩小步长$h$至原来的一半，计算$T_{2n}$；
    \item 验证误差估计条件 $|T_{2n}-T_n|<\vepsilon$ 是否满足，若满足则停止，若不满足
    则重复上一步。
\end{enumerate}

\entry $T_{2n}$的迭代算法：
\begin{equation}
T_{2n}=\frac12T_n+\frac h2\sum_{k=1}^nf\left(\frac{x_{k-1}+x_k}2\right)
\end{equation}

\entry 变步长积分公式中，同样可采用复化 Simpson 公式或复化 Cotes 公式：
\begin{gather}
I-S_{2n}\approx\frac1{4^2-1}(S_{2n}-S_n),\\
I-C_{2n}\approx\frac1{4^3-1}(C_{2n}-C_n).
\end{gather}

\entry 启发：由误差估计式 (\ref{6-e1}) 可以猜想，以下的估计式同样成立：
\[ I\approx T_{2n}+\frac1{4-1}(T_{2n}-T_n) \]
而将 $T_n$ 与 $T_{2n}$ 的表达式代入之后可得
\begin{equation}
T_{2n}+\frac1{4-1}(T_{2n}-T_n)=S_n
\end{equation}
由此说明，可以用低精度的积分公式组合出高精度的积分公式
\footnote{本质上是由插值点的增加所致。}
。对复化 Simpson 公式实行类似操作可推得
\begin{equation}
S_{2n}+\frac1{4^2-1}(S_{2n}-S_n)=\frac{4^2S_{2n}-S_n}{4^2-1}=C_n
\end{equation}


\entry \key{Romberg 积分}：进一步考虑对 Cotes 公式的结果，将得到一个新的积分公式：
\begin{equation}
C_{2n}+\frac1{4^3-1}(C_{2n}-C_n)=\frac{4^3C_{2n}-C_n}{4^3-1}=R_n
\end{equation}
称由上式表述的 $R_n$ 为 Romberg 积分，其代数精度 $m=7$，其误差估计式为
\begin{equation}
R[f]=K\cdot h^8f^{(8)}(\eta).
\end{equation}

\entry 一般不在 Romberg 积分的基础上进一步递推，因被积函数的高阶导数性态不易估计，可能
出现 Runge 现象；且$R_{2n}-R_n$ 一项很小，舍入误差较大；计算量也过大。

\entry Romberg 积分可由最基本的复化梯形公式逐阶递推而来，常用 \key{Romberg 计算图}辅助
计算。

\begin{figure}[htbp]
\small\centering
\includegraphics[width=\defwidth]{default.png}
\caption{Romberg 计算图}\label{6-f1}
\end{figure}

\section{待定系数法与 Gauss 型积分}
\trm 积分公式 $Q[f]$ 之代数精度为 $m$ 的充要条件是
\[R[x^k]=0,\,(k=0,1,2,\cdots,m),\,R[x^{m+1}]\neq0.\]
可利用此结果，在积分公式中分别代入$f(x)=x^k$，验算积分公式的代数精度。

\entry \key{待定系数法}：根据数值积分公式的一般形式 $Q[f]=\dsum_{i=0}^kA_if(x_i)$，
在给定条件下（如达到指定的代数精度、给定一些已知的节点），求解处公式中未知的节点$x_i$与
系数$A_i$。

\example 待定系数法导出梯形公式：设 $Q[f]=A_1f(a)+A_2f(b)$，希望其代数精度为 $1$，则有
\begin{itemize}
    \item 令 $f(x)=1$，由 $I[f]=Q[f]$ 有 $A_1-A_2=b-a$；
    \item 令 $f(x)=x$，由 $I[f]=Q[f]$ 有 $A_1\cdot a + A_2\cdot b=\frac12(b^2-a^2)$。
\end{itemize}
解得 $A_1=A_2=\frac{b-a}2$。故积分公式为
\[Q[f]=\frac{b-a}2[f(a)+f(b)],\]
此即梯形公式。

\entry 广义 Peano 定理：设 $Q[f]$ 的截断误差为 $R[f]$是区间上 $m+1$ 阶导数连续之函数
的线性泛函\footnote{线性泛函满足：$R[c_1f_1+c_2f_2]=R[c_1f_1]+R[c_2f_2]$。}，且近似
公式代数精度为 $m$，则有 $R[f(x)]=R[e(x)]$，其中
\begin{equation}\label{6-e2}
e(x)=\frac{f^{(m+1)}(\xi)}{(m+1)!}(x-\tilde{x}_0)(x-\tilde{x}_1)\cdots
(x-\tilde{x}_m)
\end{equation}
$\tilde{x}_0,\tilde{x}_1,\cdots,\tilde{x}_m$ 为 $[a,b]$ 上任意一点，$\xi\in[a,b]$
与这 $m+1$ 个点的选取有关。

\entry 通过合适的取点，可由广义 Peano 定理求得各积分公式的误差估计。一般要求：$e(x)$表
达式中的 $(x-\tilde{x}_0)(x-\tilde{x}_1)\cdots(x-\tilde{x}_m)$ 项在 $[a,b]$ 不变号；
选取 $\tilde{x}_0,\tilde{x}_1,\cdots,\tilde{x}_m$ 最好使 $Q[e]$ 为 $0$，从而有
$R[f]=I[e]$ 可直接算出。

\example 用广义 Peano 定理估计 Simpson 公式
\[ \int_{-1}^1f(x)\di x\approx Q[f]=\frac13[f(-1)+4f(0)+f(1)] \]
的误差，可考虑取 $-1,0,0,1$（其中 $0$ 为重节点），代入 (\ref{6-e2}) 式即得
\[ e(x)=\frac{f^{(4)}(\xi)}{4!}(x+1)x^2(x-1) \]
而可以算得 $Q[e]=0$，故直接有
\[ R[f]=I[e]=\int_{-1}^1\frac{f^{(4)}(\xi)}{4!}(x+1)(x-1)x^2\di x=
\frac1{90}f^{(4)}(\eta)\,(\eta\in[a,b]) \]
其中在 $(x+1)(x-1)x^2$ 不变号的前提下应用了广义积分中值定理。

\entry 简化解法：设数值积分公式 $Q[f]$ 的代数精度为 $m$，根据广义 Peano 定理其误差项
一定为 $Kf^{(m+1)}(\eta)$ 的形式；代入 $f(x)=x^{m+1}$ 即有
\[ K\cdot m! = R[f] = I[f] - Q[f] \]
将 $I[f]$ 与 $Q[f]$ 算出，即可求得系数 $K$。
（当 $m=4$ 时，方程左侧为 $24K$，故戏称此法为「24K金法」。

\example 用「24K金法」估计 Simpson 公式的误差。

\example 估计积分公式
\[ \int_{-1}^1f(x)\di x\approx Q[f]=\frac43f\left(-\frac12\right)-\frac23f(0)+
\frac43f\left(\frac12\right) \]
的误差。（答案：$R[f]=\frac7{720}f^{(4)}(\eta)$。）

\entry 在一般的积分公式 $Q[f]=\dsum_{i=0}^nA_if(x_i)$ 中，全部的待定参数共 $2n+2$ 个，
可将它们全部通过待定系数法解出（而不必预先给定）；因此，对由 $n+1$ 个节点确定的积分公式，
可以期望其最高具有 $m=2n+1$ 的代数精度，进而列出 $m+1=2n+2$ 个方程将待定参数解出。

\entry 最高精度为 $2n+1$：对代数精度为 $2n+1$ 的积分公式 $Q[f]=\dsum_{i=0}^nA_if(x_i)$，
可代入以下的 $2n+2$ 次多项式
\[ p(x)=(x-x_0)^2(x-x_1)^2\cdots(x-x_n)^2 \]
则有 $Q[p(x)]=\dsum_{i=0}^nA_ip(x_i)=0$，而 $I[p(x)]$ 必然为正数，故可见 $Q[f]$ 的
代数精度不可能达到 $2n+2$。

\example 求解使积分公式
\[ \int_{-1}^1f(x)\di x=Q[f]=A_0f(x_0)+A_1f(x_1) \]
代数精度尽可能高的 $A_0,A_1,x_0,x_1$，并估计误差。
（答案：$Q[f]=f(-1/\sqrt3)+f(1/\sqrt3)$，$m=3$，$R[f]=\frac1{135}f^{(4)}(\eta)$）

\entry Gauss 求积公式：具有 $n+1$ 个节点，代数精度达到 $2n+1$ 的数值积分公式。相应的
节点称为 Gauss 点。

\trm 求积公式 $Q[f]=\dsum_{i=0}^nA_if(x_i)$ 是 Gauss 求积公式的充要条件为：
\begin{itemize}
    \item $x_i$ 为 $[a,b]$ 上关于权系数 $\omega(x)$ 正交的多项式 $g_{n+1}(x)$ 之零点；
    \item 求积系数 $A_i$ 按下式确定：
    \begin{equation}
    A_i=\int_a^b\omega(x)l_i(x)\di x
    \end{equation}
\end{itemize}

\trm 引理：设$\{g_k(x)\}$ 为 $[a,b]$ 上关于 $\omega(x)$ 正交的首一正交多项式，则有
\begin{equation}
\frac{g_{k+1}(x)}{x-x_i}=\frac{\gamma_n}{g_n(x_i)}\sum_{k=0}^n\frac{g_k(x)
g_n(x_i)}{\gamma_k}
\end{equation}

\trm 推论 1：求积公式中的系数 $A_i$ 可按
\begin{equation}\label{6-e3}
A_i=\frac{\gamma_n}{g'_{n+1}(x_i)g_n(x_i)}\quad(i=0,1,\ldots,n)
\end{equation}
计算。

\trm 推论 2：若 $f\in C^{2n+2}[a,b]$，且 $g_{n+1}(x)$ 为一个首一多项式，则有
\begin{equation}\label{6-e4}
R[f]=\frac{\gamma_{n+1}}{(2n+2)!}f^{(2n+2)}(\eta).
\end{equation}

\trm 推论 3：Gauss 型求积公式的系数全大于 $0$。

\entry Gauss 型求积公式的求解过程：
\begin{enumerate}
    \item 按三项递推关系 (\ref{5-e1}) 求出在 $[a,b]$ 上关于 $\omega(x)$ 正交的
    多项式 $g_{n+1}(x)$；
    \item 求出 $g_{n+1}(x)$ 的 $n+1$ 个根 $x_0,x_1,\cdots,x_n$。
    \item 按式 (\ref{6-e3}) 求解积分公式中的系数。
    \item 按 (\ref{6-e4}) 式的结果求解误差。
\end{enumerate}

\entry Gauss 求积公式的稳定性：设计算函数值时的舍入误差
\[ |f(x_i)-\tilde{f}(x_i)|\leq\vepsilon \]
其中 $\vepsilon$ 为各子区间上最大的舍入误差限，则总的舍入误差估计为
\begin{equation}
E=\left|\sum_{i=0}^nA_if(x_i)-\sum_{i=0}^nA_i\tilde{f}(x_i)\right|\leq\sum_{i=0}%
^n|A_i|\vepsilon.
\end{equation}
对 Gauss 求积公式，所有的 $A_i$ 均为正，故有
\[ \sum_{i=0}^n|A_i|=\sum_{i=0}^nA_i=\int_a^b\omega(x)\di x=\gamma_0 \]
从而说明 $E\leq\gamma_0\vepsilon$，即舍入误差是可控的。这说明 Gauss 求积公式是稳定的。

\section{数值微分公式}
\entry 最基本的算法：割线代切线
\[ f'(x_i)\approx\frac{f(x_{i+1})-f(x_i)}{x_{i+1}-x_i}=A_if(x_i)+A_{i+1}f(x_{i+1}) \]
可见数值微分公式与数值积分公式本质相同，均为个别点函数值的组合。

\entry 以上方法的缺陷，与之前所提的朴素近似积分法相同：误差无法估计。为此，应直接从一般
的公式入手，自行求解节点与系数，并估计误差。

\entry 插值型数值微分公式：用插值多项式 $L_n(x)$ 代替原有函数 $f(x)$ ，求其导数：
\[ f(x)=L_n(x)+R_n(x)\,\Rightarrow\,f^{(k)}(x)=L_n^{(k)}(x)+R_n^{(k)}(x).\]

\entry 插值型公式的误差估计：
\[ R_n^{(k)}(x)=\frac{\di^k}{\di x^k}\left[\frac{f^{(n+1)}(\xi)}{(n+1)!}
\pi_{n+1}(x)\right]=\frac{\di^k}{\di x^k}\left(f[x_0,x_1,\cdots,x_n,x]\pi_{n+1}(x)
\right) \]

\trm 差商的导数有如下性质：
\begin{equation}
\frac{\di^k}{\di x^k}f[x_0,x_1,\cdots,x_m,x]=(k!)f[x_0,x_1,\cdots,x_m,x,x,\cdots,x].
\end{equation}

\entry 两点数值微分公式（$n=1,k=1$）：采用 Newton 插值多项式可求得
\[ f'(x)=f[x_0,x_1] + f[x_0,x_1,x,x](x-x_0)(x-x_1)+ f[x_0,x_1,x](2x-x_0-x_1) \]
分别代入 $x_0$ 与 $x_1$ 可得两个数值微分公式：
\begin{gather}
f'(x_0)=\frac{f(x_1)-f(x_0)}{x_1-x_0}+\frac12f''(\xi_0)(x_0-x_1)\\
f'(x_1)=\frac{f(x_1)-f(x_0)}{x_1-x_0}+\frac12f''(\xi_1)(x_0-x_1)
\end{gather}
可通过记 $h=x_1-x_0$ 来简化以上公式的写法。

\entry 三点数值微分公式（$n=2,k=1$）：设三个等距节点分别为 $x_0,x_1,x_2$，可得到相同
结论为
\begin{gather}
f'(x_0)=\frac1{2h}[-3f(x_0)+4f(x_1)-f(x_1)]+\frac{h^2}3f'''(\xi_0)\\
f'(x_1)=\frac1{2h}[-f(x_0)+f(x_2)]-\frac{h^2}6f'''(\xi_1)\\
f'(x_2)=\frac1{2h}[f(x_0)-4f(x_1)+3f(x_2)]+\frac{h^2}3f'''(\xi_2).
\end{gather}

\entry 三点二阶数值微分公式（$n=2,k=2$）：在以上公式推导过程中再求一次导，分别代入三个
等距节点即得 
\begin{gather}
f''(x_0)=\frac1{h^2}[f(x_0)-2f(x_1)+f(x_2)]-hf'''(\xi_1)+\frac{h^2}6f^{(4)}(\xi_2)\\
f''(x_1)=\frac1{h^2}[f(x_2)-2f(x_1)+f(x_2)]-\frac{h^2}{12}f^{(4)}(\xi)
\label{7-e-mid}\\
f''(x_2)=\frac1{h^2}[f(x_0)-2f(x_1)+f(x_2)]+hf'''(\xi_1)+\frac{h^2}6f^{(4)}(\xi_2).
\end{gather}

\entry 一般，常用以下两个在区间中点$x_1$取得的数值微分公式：
\begin{gather}
f'(x)=\frac{f(x+h)-f(x-h)}{2h}-\frac{h^2}6f'''(\xi),\\
f''(x)=\frac{f(x+h)-2f(x)+f(x+h)}{h^2}-\frac{h^2}{12}f^{(4)}(\xi).
\end{gather}

\entry 数值微分的待定系数法：类似于数值积分，可用待定系数法追求更高的代数精度。（此处，
代数精度的定义与数值积分中的相同。）

\example 给定 $x_0,x_1$，为求得下列形式的数值微分公式
\[ f''(x_0)\approx c_0f(x_0)+c_1f'(x_0)+c_2f(x_1) \]
中系数 $c_0,c_1,c_2$ 的值，首先期望该公式具有 $m=1+1=2$ 的代数精度，进而可依次代入
$f(x)=1$、$f(x)=x$、$f(x)=x^2$：
\[\begin{cases}-c_0-c_2=0\\-c_1-c_2h=0\\2-c_2h^2=0\end{cases}\sothat
\begin{cases}c_0=-\frac{2}{h^2}\\c_1=-\frac2h\\c_2=\frac2{h^2}\end{cases}\]
可将 $f(x)=x^3$ 代入最终的公式中，解得 $R[f]=-2h\neq0$，故该公式的代数精度止于 $2$。
此处可用广义 Peano 定理，取$x_0,x_0,x_1$ 三个节点构筑 $e(x)$，从而
\[R[f]=R[e(x)]=e''(x_0)-\left[-\frac2{h^2}e(x_0)+\frac2he'(x_0)-\frac2{h^2}e(x_1)
\right]=e''(x_0)=-\frac h3f'''(\xi).\]
（当然，也可以用「24K金法」，将 $f(x)=x^3$ 直接代入 $I[f]=R[f]$ 之中，
求得系数 $K=-\frac h3$。）

\entry 外推法：类似于 Romberg 积分法，用低精度公式递推出高精度公式。

\entry 变步长微分法：类于数值积分中的类似方法。

\example 欲求得数值微分公式
\[ f''(x)\approx Af(x-h)+Bf(x)+Cf(x+h) \]
中的系数 $A,B,C$，可利用 Taylor 公式展开等式右侧的 $f(x-h)$ 与 $f(x-h)$：
\[ f''(x)=(A+B+C)f(x)+(-A+C)hf'(x)+(A+C)\frac{h^2}2f''(x)+R(x) \]
其中 $R(x)$ 为余项。左右对应项相等，故有
\[
\begin{cases}A+B+C=0\\-A+C=0\\A+C=\frac2{h^2}\end{cases}\sothat
\begin{cases}A=-\frac1{h^2}\\B=-\frac2{h^2}\\C=\frac1{h^2}\end{cases}
\]
故可推出数值微分公式为
\[ D_h[f]=\frac1{h^2}[f(x-h)-2f(x)+f(x+h)] \]
为提高该公式的精度，可再 $h/2$ 为步长，能递推出近似关系
\[ f''(x)-D_{\frac12h}[f]\approx\frac14(f''(x)-D_h[f])\sothat
f''(x)\approx\frac13\left[4D_{\frac h2}[f]-D_h[f]\right]. \]
记 $\overline{D}[f]=\frac43D_{\frac h2}[f]-\frac13D_h[f]$，该公式相较于上式更为精确。

\chapter{非线性方程迭代解法}
\entry 非线性方程：在化简方程为
\[ f(x)=0 \]
的形式后，$f(x)$ 中含有 $x$ 的非线性项，如 $x^2$、$\sin x$、$\e^x$ 等。
线性方程以外的代数、函数方程均是非线性方程。

\entry 迭代解法：泛指在已知结果的基础上，利用统一的迭代格式，从给定初值 $\{x^{(0)}\}$
出发，使递推数列 $\{x^{(k)}\}$ 逼近方程解的解法。

\entry 迭代解的要素：
\begin{enumerate}
    \item 迭代格式的构造；
    \item 初值 $x^{(0)}$ 的选取；
    \item 迭代数列 $\{x^{(k)}\}$ 的选取；
    \item 迭代终止条件与误差估计。
\end{enumerate}

\section{迭代法简述}
\entry 二分法：根据零点存在定理，不断二分方程之解所在的区间，用「区间套」逼近方程之解。
\begin{figure}[htbp]
\small\centering
\includegraphics[width=\defwidth]{default.png}
\caption{二分法示意}\label{7-f1}
\end{figure}
二分法过程稳定，但运算量大（需反复计算函数值），且收敛较慢
\footnote{每迭代 $10$ 次，解所在的区间范围缩小到原来的 $1/1024\approx1/1000$，相当于
提高了 $3$ 位有效数字。也即：需要迭代超过 $3$ 次才能增加解的一位有效数字。}
，故常用于初步确定初值 $x^{(0)}$ 的范围（而不用于最终确定解）。

\entry 简单迭代法：构造非线性方程 $f(x)=0$ 的同解变形 $x=\vphi(x)$，例如
\[ x = x - f(x),\quad x=x-kf(x) \]
等，再构造迭代格式为
\begin{equation}
x_{k+1}=\vphi(x_k).
\end{equation}
若 $\{x_k\}$ 收敛到 $x^\ast$，$\vphi(x)$ 也在 $x^\ast$ 处连续，则对以上方程左右取极
限即得 $x^\ast=\vphi(x^\ast)$，说明该迭代法可以逼近方程之解。

\entry Newton 法：设非线性方程 $f(x)=0$ 之解为 $x^\ast$，即 $x^\ast = 0$，将其
在 $x_k$ 处展开可得
\[ f(x_k)+f'(x_k)(x^\ast-x_k)+\cdots = 0 \]
舍去二阶项，有 $f(x_k)+f'(x_k)(x^\ast-x_k)\approx0$，进而可变换得到
\[x^\ast\approx x_k-\frac{f(x_k)}{f'(x_k)}\]
改写其为一个迭代格式即得
\begin{equation}\label{7-e1}
x_{k+1} = x_k-\frac{f(x_k)}{f'(x_k)}
\end{equation}
可验证该方程确为 $f(x)=0$ 的同解变形，故该迭代格式收敛时必能得到方程之解。

\entry 根据 Newton 法的几何意义，其又被称为\key{切线法}。

\entry 改进 Newton 法：在上面的展开式中，若进一步保留到二次项，可解得：
\[ x^\ast\approx x_k+\frac{-f'(x_k)\pm\sqrt{f'(x_k)^2-2f(x_k)f''(x_k)}}{f''(x_k)} \]
分母中的正负号不定，故可改写出两种迭代格式：
\begin{gather}
\tilde{x}_{k+1}=x_k-\frac{f'(x_k)+\sgn(f'(x_k))\sqrt{f'(x_k)^2-2f(x_k)f''(x_k)}
}{f''(x_k)},\\
\overline{x}_{k+1}=x_k-\frac{2f(x_k)}{f'(x_k)+\sgn(f'(x_k))\sqrt{f'(x_k)^2-2f(x_k)
f''(x_k)}}.
\end{gather}
选取 $\tilde{x}_{k+1}$ 与 $\overline{x}_{k+1}$ 中距离 $x_k$ 更近者，作为下一步迭代
时的 $x_{k+1}$ 即可。

\entry 简化 Newton 法：若 $f'(x)$ 难以计算，可将迭代格式 (\ref{7-e1}) 改写为
\begin{equation}
x_{k+1}=x_k-\frac{f(x_k)}{f'(x_0)}
\end{equation}
即始终采用初值点处导数近似表示 $f'(x_k)$。

\entry 弦割法：将迭代格式 (\ref{7-e1}) 中的导数 $f'(x_k)$ 用两点数值微分公式代替，可
得到：
\begin{itemize}
    \item 若用 $x_k$ 与 $x_{k-1}$ 作为迭代格式中的两点，则得
    \begin{equation}
    x_{k+1} = x_k-\frac{f(x_k)}{\frac{f(x_k)-f(x_{k-1})}{x_k-x_{k-1}}} =
    x_k-\frac{f(x_k)(x_k-x_{k-1})}{f(x_k)-f(x_{k-1})}
    \end{equation}
    此即\key{两点弦割法}。
    \item 若用 $x_k$ 与 $x_0$ 作为迭代格式中的两点，则得
    \begin{equation}
    x_{k+1} = x_k-\frac{f(x_k)}{\frac{f(x_k)-f(x_0)}{x_k-x_0}} =
    x_k-\frac{f(x_k)(x_k-x_0)}{f(x_k)-f(x_0)}
    \end{equation}
    此即\key{单点弦割法}。
\end{itemize}

\entry 弦割法需要给定两步初值 $x_0$ 与 $x_1$ 才能进行，该初值通常由其他方法获得。

\entry 切线法与弦割法的几何意义：
\begin{figure}[htbp]
\small\centering
\includegraphics[width=\defwidth]{default.png}
\caption{迭代解法的几何意义}\label{7-f2}
\end{figure}

\section{迭代法的收敛理论}
\entry 迭代法的两种收敛性：设非线性方程 $f(x)=0$ 在 $[a,b]$ 上有解 $x^\ast$，取定迭
代格式 $x_{k+1}=\vphi(x_k)$ 与初值 $x_0$。若
\begin{itemize}
    \item 存在 $x^\ast$ 的一个小邻域，使得只要 $x_0$ 在此邻域中就能保证 $\{x_k\}$ 收
    敛\footnote{根据迭代格式的意义，当 $\{x_k\}$ 收敛时其必收敛于 $x^\ast$。}
    ，则称迭代格式局部收敛；
    \item 对任意的 $x_0\in[a,b]$，都有 $\{x_k\}$ 收敛，则称迭代格式全局收敛。
\end{itemize}

\trm 全局收敛定理（压缩映射原理）：设 $\vphi(x)\in C[a,b]$，且满足：
\begin{enumerate}
    \item $x\in[a,b]$ 时，$\vphi(x)\in[a,b]$；
    \item 存在 $L\in[0,1)$，使得对任意的 $x\in[a,b]$都有
    \begin{equation}
    |\vphi'(x)|\leq L<1.
    \end{equation}
\end{enumerate}
则由 $\vphi(x)$ 所构造的 $x_{k+1}=\vphi(x_k)$ 将是一个在 $[a,b]$ 上全局收敛的迭代
数列，且其满足以下误差估计式：
\begin{gather}
|x^\ast-x_k|\leq\frac{L^k}{1-L}|x_1-x_0|,\quad\text{（先验估计）}\\
|x^\ast-x_k|\leq\frac1{1-L}|x_{k+1}-x_k|.\quad\text{（事后估计）}
\end{gather}

\entry 以上定理的结果，仅是全局收敛的充分条件，而非必要条件。

\trm 局部收敛定理：设方程 $f(x)=0$ 有解 $x^\ast$，构造了一个迭代格式
$x_{k+1}=\vphi(x_k)$。若存在 $x^\ast$ 的某邻域 $[x^\ast-\delta,x^\ast+\delta]$ 使
\[ |\vphi'(x)|\leq L<1 \]
则迭代格式 $x_{k+1}=\vphi(x_k)$ 在该邻域上局部收敛。

\trm Newton 迭代法的局部收敛定理：设非线性方程 $f(x)=0$ 有解 $x^\ast$，在 $x^\ast$
附近 $f(x)$ 二阶连续可微，$f'(x^\ast)\neq0$，则 Newton 迭代格式 (\ref{7-e1}) 在 
$x^\ast$ 的充分小邻域内局部收敛。（或：当初值 $x_0$ 充分靠近 $x^\ast$ 时，Newton
迭代法收敛。）

\trm Newton 迭代法的全局收敛定理：设非线性方程 $f(x)=0$ 在 $[a,b]$ 上有解 $x^\ast$，
且 $f(x)$ 在 $[a,b]$ 上二阶连续可微。则 Newton 迭代格式 (\ref{7-e1}) 在 $[a,b]$ 上
全局收敛的充分条件是：
\begin{enumerate}
    \item $f(a)f(b)<0$；
    \item 对任意的$x\in[a,b]$，$f'(x)\neq0$；
    \item $f''(x)$ 在 $[a,b]$ 上不变号；
    \item 初值 $x_0$ 满足 $f(x_0)f''(x_0)>0$。
\end{enumerate}

\trm 弦割法局部收敛的条件与 Newton 法类似，只要 $x_0,x_1$ 两步初值充分靠近 $x^\ast$。

\trm 弦割法全局收敛定理：在 Newton 法的所有条件之基础上，还应附加满足 $f(x_1)f''(x_1)
>0$。

\define 收敛阶：设 $\{x_k\}$ 按某种迭代格式收敛于方程的解 $x^\ast$，若存在常数 $p\geq1$
与 $c>0$ 使条件
\begin{equation}
\lim_{k\to\infty}\frac{|x^\ast-x_{k+1}|}{|x^\ast-x_k|^p}=c\neq0
\end{equation}
成立，则称 $\{x_k\}$ 以 $p$ 阶收敛到方程之解。称 $c$ 为渐进误差常数。

\entry $p=1$时，称为线性收敛，否则称为超线性收敛。

\trm （整数）收敛阶定理：设 $\vphi(x)$ 在不动点上 $x^\ast$ 的邻域内有连续的 $p$ 阶
导数，则由 $x_{n+1}=\vphi(x_k)$ 生成的 $\{x_k\}$ 以 $p$ 阶收敛的充要条件是：
\[\vphi'(x^\ast)=\vphi''(x^\ast)=\cdots=\vphi^{(p-1)}(x^\ast)=0,\,\vphi^{(p)}
(x^\ast)\neq0.\]

\entry 常见迭代格式的收敛阶：
\begin{itemize}
    \item 简单迭代法：当 $0<|\vphi'(x^\ast)|<1$时线性收敛。
    \item Newton 法：当 $f'(x)\neq0$时二阶收敛。
    \item 两点弦割法：满足收敛条件时具有 $p=\frac{1+\sqrt5}2\approx1.618$ 的收敛阶，
    超线性收敛。
    \item 单点弦割法：满足收敛条件时线性收敛。 
\end{itemize}

\entry 加速收敛方法：促使原来收敛较慢的算法更快收敛，或使原来发散的迭代格式变为收敛。

\entry 松弛因子加速法：对迭代格式 $x=\vphi(x)$，在方程左右减去一带松弛因子 $\omega$
的项 $\omega x$，得
\[ x-\omega x=\vphi(x)-\omega x \]
进而可得新的收敛格式
\begin{equation}
x=\frac{\vphi(x)-\omega x}{1-\omega}=\psi(x)
\end{equation}
为检查该迭代格式的收敛性，可以对其求导得
\[ \psi'(x)=\frac1{1-\omega}(\vphi'(x)-\omega) \]
若代入 $\omega=\vphi'(x^\ast)$，则在 $x^\ast$ 附近时 $|\psi(x^\ast)|$ 相当小，由此即
可保证 $|\psi'(x)|\leq L<1$ 的条件成立（将发散的迭代格式改进为收敛的），并提高收敛速率。

\entry Aitken 加速法。

\chapter{常微分方程数值解}
\entry 本章只涉及一阶常微分方程初值问题：
\begin{equation}\label{8-e1}
\begin{cases}
y'(x)=f(x,y(x)),\quad x\in[a,b]\\
y(a)=y_0.
\end{cases}
\end{equation}

\trm 解的存在唯一性：在由式 (\ref{8-e1}) 所述的初值问题中，若 $f(x,y)$ 在区域
\[D=\{(x,y)|a\leq x\leq b,-\infty<y<+\infty\}\]
中连续，且存在一个常数 $L$ 使得对任意选取的 $y$ 与 $\bar{y}$ 都有
\footnote{不等式中的第一个不等号，来自于多元函数的拟微分中值定理。}
\[ |f(x,y)-f(x,\bar{y})|\leq|\frac{\del f}{\del y}(y-\bar{y})|\leq L|y-\bar{y}|,
\quad x\in[a,b] \]
则该初值问题在 $[a,b]$ 上存在唯一连续可微解 $y=y(x)$。

\entry 用数值计算方法，求出初值问题 (\ref{8-e1}) 在给定的若干节点 $x_i\in[a,b]$ 上之
数值解 $y_i\approx y(x_i)$。

\entry 一般记 $x_i$ 处的精确解为 $y(x_i)$，数值近似解则记为
$y_i$。

\section{常用解法的导出}
\entry 数值微分法：在初值问题 (\ref{8-e1}) 中，用某一数值微分公式
\[ y'(x_i)=y'_i+R[y] \]
（其中 $y'_i$ 为近似解，$R[y]$ 为误差项）替换原方程中的 $y'(x_i)$，进而求出一个求解
$y_i$ 的数值公式。

\entry Euler 法：在 (\ref{8-e1}) 中代入 $x=x_i$，并利用 $x_i$ 与 $x_{i+1}$ 间的两点
数值微分公式替换 $y'(x_i)$，可得到关系式
\[ \frac{y(x_{i+1})-y(x_i)}{h}-\frac12y''(\xi_i)h=f(x_i,y(x_i)) \]
作局部化假设 $y(x_i)=y_i$ （即认为 $x_i$ 处的解已准确算出），并略去关于 $h$ 的高阶项，
则可最终获得关于 $y_{i+1}$ 的递推关系
\begin{equation}
y_{i+1}=y_i+hf(x_i,y_i)
\end{equation}
此法称为 Euler 法。

\entry 局部截断误差：根据两点数值微分公式的误差，可知 Euler 法的截断误差为
\begin{equation}
R[x_i]=\frac{h^2}2y''(\xi_i).
\end{equation}

\entry 全局截断误差：在局部化假设处处成立（即每一步所用的前提条件都准确无误）之前提下，
全局误差可估计为
\begin{equation}
R(x_N)=\sum_{i=0}^{N-1}R[x_i]=\frac{b-a}2\cdot hf''(\xi).
\end{equation}

\entry 后退 Euler 法：在初值问题中代入 $x=x_{i+1}$，并利用 $x_i$ 与 $x_{i+1}$ 间的两
点数值微分公式替换 $y'(x_i)$，可得到关系式
\[ \frac{y(x_{i+1})-y(x_i)}{h}-\frac12y''(\xi_{i})h=f(x_{i+1},y(x_{i+1})) \]
作局部化假设 $y_{i+1}=y(x_{i+1})$并略去关于 $h$ 的高阶项，可获得关系式
\begin{equation}
y_{i+1}=y_i+hf(x_{i+1},y_{i+1})
\end{equation}
此法称为后退 Euler 法。

\entry 后退 Euler 法中，$y_{i+1}$ 不能显式解出，在 $f$ 为非线性函数时必须采用迭代解法，
称该法为\key{隐式解法}；Euler 法中可直接由 $x_i$ 解出 $y_{i+1}$，故称为\key{显式解法}。

\entry 后退 Euler 法的局部截断误差为
\begin{equation}
R[x_i]=-\frac{h^2}2y''(\xi_i),
\end{equation}
与 Euler 法的符号相反。

\entry 中点法：在初值问题中代入 $x=x_{i+1}$，并代入中点处的三点微分中值公式
(\ref{7-e-mid})，可得到关系式
\[ \frac{y(x_{i+1})-y(x_{i-1})}{2h}-\frac{h^2}6y'''(\xi_i)=f(x_i,y(x_i)) \]
作局部化假设 $y_{i+1}=y(x_{i+1})$并略去关于 $h$ 的高阶项，可获得关系式
\begin{equation}
y_{i+1}=y_{i-1}+2hf(x_i,y_i)
\end{equation}
此法称为中点法。

\entry 中点法中，应用了 $x_{i-1}$ 与 $x_i$ 两个前提条件，为此需在初值条件 $y_0$ 的
基础上额外补充\key{表头元素} $y_1$，为此称中点法为一个\key{多步法}。与此相对，两种
Euler 法都是\key{单步法}。

\entry 多步法的表头元素，常用单步法提供。

\entry 一般不采用点数更多的数值微分公式：精度提高优先，且需要补充更多表头元素。

\define 公式的精度：若某一微分方程的数值解法的局部截断误差记为 $R[x_i]$，其满足
\[ R[x_i]=y(x_{i+1})-y_{i+1}=O(h^{p+1}) \]
则称该解法（公式、方法）的精度为 $p$ 阶。

\entry 在数值微分法的各方法中：两种 Euler 法的精度均为一阶，中点法为二阶。

\entry 数值积分法：对微分方程初值问题 (\ref{8-e1}) 作积分，得到同解的积分方程问题
\begin{equation}
y(x)=y(a)+\int_a^xf(x,y(x))\di x\quad(x\in[a,b])\\
\end{equation}
在问题中替换区间 $[a,b]$ 为$[x_i,x_{i+1}]$，再利用数值积分公式替代方程中的积分表达式，
求得关于 $y_{i+1}$ 的关系式。

\entry 对子区间上积分 $\int_{x_i}^{x_{i+1}}f(x,y(x))\di x$，采用
\begin{itemize}
    \item 矩形数值积分公式近似：可分别获得数值解法
    \begin{gather}
    y_{i+1}=y_i+hf(x_i,y_i)\\
    y_{i+1}=y_i+hf(x_{i+1},y_{i+1})
    \end{gather}
    此即 Euler 法与倒退 Euler 法，均为一阶公式。
    \item 梯形公式近似：可获得数值解法
    \begin{equation}
    y_{i+1}=y_i+\frac h2[f(x_i,y_i)+f(x_{i+1},y_{i+1})]
    \end{equation}
    此公式也称梯形公式，是一个二阶隐式公式，误差估计为
    \begin{equation}
    R[x_i]=-\frac{h^3}{12}f'''(\xi_i).
    \end{equation}
    \item Simpson 公式：可获得数值解法
    \begin{equation}
    y_{i+1}=y_{i-1}+\frac h3[f(x_{i-1},y_{i-1})+4f(x_i,y_i)+f(x_{i+1},y_{i+1})]
    \end{equation}
    此公式也称为 Simpson 公式，是一个四阶两步隐式公式，误差估计为
    \begin{equation}
    R[x_i]=-\frac{h^5}{90}y^{(5)}(\xi_i).
    \end{equation}
\end{itemize}

\entry Adams 显式公式：为求 $y_{i+1}$ 的值，给定之前的 $(x_{i-k},f_{i-k}),(x_{i-k+1},
f_{i-k+1}),\cdots,(x_i,f_i)$ 共 $(k+1)$ 个点（其中 $f_n=f(x_n,y_n)$），作插值多项式
\[ f(x,y)=L_k(x)+R_k(x) \]
以获得 $y'(x)$ 的近似表示，进而在同解积分问题中近似代入
\[ \int_{x_i}^{x_{i+1}}y'(x)\di x=\int_{x_i}^{x_{i+1}}L_k(x)\di x \]
从而可以获得一显式的数值解公式
\begin{gather}
y_{i+1}=y_i+\frac hA\cdot(b_0f_i+b_1f_{i-1}+\cdots+b_kf_{i-k})\quad(i\geq k)\\
R[x_i]=B_kh^{k+2}y^{(k+2)}(\xi_i)
\end{gather}
称为 Adams 显式公式。式中的系数 $A$、$f_i$、$B_k$ 可据实推导，亦可直接查现成的系数表。

\entry Adams 隐式公式：与 Adams 显式公式推导类似，但在给定的 $k+1$ 数据点中，将最前的
$(x_{i-k},y_{i-k})$ 替换为待求的 $(x_{i+1},y_{i+1})$，仍作插值多项式，进而可求解得到
一隐式的数值解公式
\begin{gather}
y_{i+1}=y_i+\frac h{A^\ast}\cdot(b^\ast_0f_{i+1}+b^\ast_1f_i+\cdots+b^\ast_kf_{i
-k+1})\quad(i\geq k)\\
R[x_i]=B^\ast_kh^{k+2}y^{(k+2)}(\xi_i)
\end{gather}
称为 Adams 隐式公式。式中系数可据实推导，也可直接查表。

\section{预测-校正方法与一般性理论}
\entry 一般而言，显式法易于计算，但隐式法的稳定性较显式法高。

\entry 可以考虑在求解过程中，先用（低阶）显式公式初步求得 $y_{i+1}$ 的近似值，再直接代
入（高阶）隐式公式中以直接求得更稳定的解。此类方法统称预估-校正法。

\entry 改进 Euler 法：用 Euler 法预估，再用倒退 Euler 法校正：
\begin{equation}
\begin{cases}
p_{i+1}=y_i+h(x_i,y_i)\\
y_{i+1}=y_i+h(x_{i+1},p_{i+1})
\end{cases}.
\end{equation}
此法仍是一阶解法，但稳定性比 Euler 法更高，也不用像倒退 Euler 法一样隐式求解。

\entry Heun 方法：用 Euler 法预估，用梯形公式校正：
\begin{equation}
\begin{cases}
p_{i+1}=y_i+h(x_i,y_i)\\
y_{i+1}=y_i+\frac h2[f(x_i,y_i)+f(x_{i+1},p_{i+1})]
\end{cases}
\end{equation}
此法是二阶方法。

\entry 为考虑更一般的情形，可将 Heun 方法改写为
\begin{equation}
\begin{cases}
y_{i+1}=y_i+\frac12K_1+\frac12K_2\\
K_1=hf(x_i,y_i)\\
K_2=hf(x_i+h,y_i+K_1)
\end{cases}
\end{equation}
式中，$K_1$ 与 $K_2$ 是利用已有的 $(x_i,y_i)$ 信息依次用 $f$ 推演所得的「补充信息」。

\entry Runge-Kutta 法（RK 法）：将以上所言的「补充信息」一般化，可得如下的解法：
\begin{equation}
\begin{cases}
y_{i+1}&=y_i+\lambda_1K_1+\lambda_2K_2+\cdots+\lambda_mK_m\\
K_1&=hf(x_i,y_i)\\
K_2&=hf(x_i+\alpha_2h,y_i+\beta_{21}K_1)\\
K_3&=hf(x_i+\alpha_3h,y_i+\beta_{31}K_1+\beta_{32}K_2)\\
\vdots&\\
K_m&=hf(x_i+\alpha_mh,y_i+\beta_{m1}K_1+\cdots+\beta_{m,m-1}K_{m-1})
\end{cases}
\end{equation}
式中的 $\lambda_k,\alpha_k,\beta_{ij}$等系数待定。为追求 $m$ 阶的精度，即达到
\begin{equation}
R[x_i]=o(h^{m+1})
\end{equation}
的截断误差，可将 $R[x_i]$ 的表达式在 $x_i$ 处展开，使其低于 $m+1$ 次各项系数为 $0$，
进而列解方程确定方法。

\entry 实际问题中，方程数往往小于系数个数，此时可自由选取个别系数，以确定其他系数。
（由此得到的是不同的解法。）

\example 二阶 Runge-Kutta 法。

\example 四阶 Runge-Kutta 法。

\entry Runge-Kutta 是单步显式方法，可直接求解，精度很高。缺点是计算量大。

\entry 可将之前所提的所有解法统一成以下的形式：
\begin{equation}\label{8-e2}
y_{i+1}=\sum_{j=0}^K\alpha_jy_{i-j}+K\sum_{j=-1}^K\beta_jf_{i-j}.
\end{equation}
当 $K=0$ 时，其表示了一个单步法，否则表示了一个多步法。当 $\beta_{-1}=0$ 时，其表示了
一个显式公式，否则表示的是隐式公式。含 $y_{i-j}$ 的项决定了方程的步数，而含 $f_{i-j}$
的项决定了方程的阶数。

\entry 待定系数法：对由 (\ref{8-e2}) 概括的数值解法，可计算其截断误差
\begin{equation}
R[x_i]=y(x_{i+1})-y_{i+1}=y(x_{i+1})-\sum_{j=0}^K\alpha_jy(x_{i-j})-h\sum{j=-1}%
^K\beta_jy'(x_{i-j}).
\end{equation}
利用 Taylor 公式将 $R[x_i]$ 中各项在 $x_i$ 处展开，为尽可能地使方法有高的精度，设其各
低次项的系数为 $0$，由此即可列解系数方程。进而可用广义 Peano 定理或「24K金法」求解截断
误差的系数。

\example 为确定所有可能的三阶两步方法，根据一般形式 (\ref{8-e2}) 可设出如下形式的解法：
\[ y_{i+1}=\alpha_0y_i+\alpha_1y_{i-1}+h(\beta_{-1}f_{i+1}+\beta_0f_i+\beta_1
f_{i-1}) \]

\section{解与解法的分析方法}

\backmatter
\chapter*{后记}

\printindex

\end{document}